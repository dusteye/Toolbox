<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-cn" lang="zh-cn" >
<head>
<title>Spring Framework Validation - WIKI-HIT IBM CLUB</title>
<meta name="KEYWORDS" content="首页,ALP,Address,Android,Android Newbie Guide,Android Project Development,Android Research Field,Android Third Party Lib And Tool,BoardGame,CSAPP" />
<meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
<meta name="robots" content="index,follow" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel='stylesheet' type='text/css' media='print' href='../../../../skins/common/wikiprintable.css' />
<script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
<style type='text/css'>
/*/*/ /*<![CDATA[*/
@import "../../../../skins/common/wikistandard.css";
@import "../../../s/t/a/MediaWiki%7EStandard.css.html";
a.new, #quickbar a.new { color: #CC2200; }
.editsection { display: none; }
#quickbar { position: absolute; top: 4px; left: 4px; border-right: 1px solid gray; }
#article { margin-left: 152px; margin-right: 4px; }

/*]]>*/ /* */
</style>
</head>

<body bgcolor='#FFFFFF' onload=''>

<div id='content'>
<div id='topbar'>
<table border='0' cellspacing='0' width='98%'>
<tr>
<td width='152' rowspan='1'>&nbsp;</td><td class="top" align='left' valign='top'>
<a href="../../../index.html" title="首页">首页</a> |
<a href="../../../r/e/c/Special%7ERecentchanges.html" title="Special:Recentchanges">最近更改</a> |
<a href="../../../s/p/r/Spring_Framework_Validation_26d6.html" title="Spring Framework Validation">编辑本页</a> |
<a href="../../../s/p/r/Spring_Framework_Validation_26d6.html" title="Spring Framework Validation">较早版本</a><p class='subtitle'><a href="../../../s/p/r/Spring_Framework_Validation_26d6.html">可打印版</a> | <a href="../../../g/e/n/WIKI-HIT_IBM_CLUB%7EGeneral_disclaimer.html" title="WIKI-HIT IBM CLUB:General disclaimer">Disclaimers</a></p>
</td>
<td class="top" valign='top' align='right' nowrap='nowrap'>Not logged in
<br /><a href="../../../u/s/e/Special%7EUserlogin.html" title="Special:Userlogin">登录</a> | <a href="../../../w/i/k/Wikipedia%7E%E5%B8%AE%E5%8A%A9.html" title="Wikipedia:帮助">帮助</a>
<br /><form name="search" class="inline" method="post" action="../../../s/e/a/Special%7ESearch.html">
<input type="text" name="search" size="19" value="" />
<input type="submit" name="go" value="进入" />&nbsp;<input type="submit" name="fulltext" value="搜索" />
</form></td></tr>
</table>
</div>

<div id='article'>
<h1 class="pagetitle">Spring Framework Validation</h1><p class='subtitle'>Wikipedia，自由的百科全书</p>
<table id='toc' class='toc'><tr><td><div id='toctitle'><h2>目录</h2></div>
<ul>
<li class='toclevel-1'><a href="#.E9.85.8D.E7.BD.AE.E6.96.87.E4.BB.B6"><span class="tocnumber">1</span> <span class="toctext">配置文件</span></a></li>
<li class='toclevel-1'><a href="#.E6.95.B0.E6.8D.AE.E9.AA.8C.E8.AF.81.E7.B1.BB"><span class="tocnumber">2</span> <span class="toctext">数据验证类</span></a></li>
<li class='toclevel-1'><a href="#.E6.B3.A8.E5.86.8C.E7.95.8C.E9.9D.A2"><span class="tocnumber">3</span> <span class="toctext">注册界面</span></a></li>
<li class='toclevel-1'><a href="#scholar.E9.85.8D.E7.BD.AE.E6.96.B9.E5.BC.8F"><span class="tocnumber">4</span> <span class="toctext">scholar配置方式</span></a></li>
</ul>
</td></tr></table>
<p><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "显示"; var tocHideText = "隐藏"; showTocToggle(); } </script>
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/p/r/Spring_Framework_Validation_26d6.html" title="Spring Framework Validation">编辑</a>]</div><a name=".E9.85.8D.E7.BD.AE.E6.96.87.E4.BB.B6"></a><h2> 配置文件 </h2>
<ul><li>一般配置方式
</li><li>配置了一个数据验证Bean
</li></ul>
<p>例如：在配置文件中添加&lt;bean id="RegisterValidator"　class="net.xiaxin.validator.RegisterValidator"/&gt;
</p>
<ul><li>修改相应的Action类的配置
</li></ul>
<p>1.添加命令对象，命令对象就是传给验证器来验证的对象，他的属性与表单的参数相对应
</p><p>例如：
</p>
<pre>&lt;property name="commandClass"&gt;
    &lt;value&gt;net.xiaxin.reqbean.RegisterInfo&lt;/value&gt;
&lt;/property&gt;
</pre>
<p>2.增添数据验证Bean的属性
</p>
<pre>&lt;property name="validator"&gt;
    &lt;ref local="RegisterValidator"/&gt;
&lt;/property&gt;
</pre>
<p>3.指定本处理单元的显示界面
　
</p>
<pre>&lt;property name="formView"&gt;
   &lt;value&gt;register&lt;/value&gt;
&lt;/property&gt;
</pre>
<p>4.指定成功返回界面
</p>
<pre>&lt;property name="successView"&gt;
   &lt;value&gt;RegisterSuccess&lt;/value&gt;
&lt;/property&gt;
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/p/r/Spring_Framework_Validation_26d6.html" title="Spring Framework Validation">编辑</a>]</div><a name=".E6.95.B0.E6.8D.AE.E9.AA.8C.E8.AF.81.E7.B1.BB"></a><h2> 数据验证类 </h2>
<p>在Spring中，所有的数据验证类都必须实现接口:org.springframework.validation.Validator
</p><p>Validator接口定义了两个方法：
</p><p>1.boolean supports(Class clazz);
</p><p>用于检查当前输入的数据类型是否符合本类的检验范围。Spring调用Validator实现类时，首先会通过这个方法检查数据类型是否与此Validator相匹配。
</p><p>2.void validate(Object obj, Errors errors);
</p><p>数据校验方法。Validator实现类通过实现这个方法，完成具体的数据校验逻辑。
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/p/r/Spring_Framework_Validation_26d6.html" title="Spring Framework Validation">编辑</a>]</div><a name=".E6.B3.A8.E5.86.8C.E7.95.8C.E9.9D.A2"></a><h2> 注册界面 </h2>
<p>主要是&lt;spring:bind&gt; 标记的使用:
</p>
<ul><li>&lt;spring:bind&gt;标记通过path参数与CommandClass对象相绑定。之后我们就可以对绑定的CommandClass对象的状态信息进行访问
</li></ul>
<ul><li>在&lt;spring:bind&gt;语义内，可以通过${status.*}访问对应的状态属性。
</li></ul>
<p>${status.*} 对应的实际是类org.springframework.web.servlet.support.BindStatusBindStatus类提供了与当前CommandClass对象绑定的状态信息，如：
</p>
<pre>${status.errorMessages}对应绑定对象属性的错误信息。
${status.expression}对应绑定对象属性的名称。
${status.value}对应绑定对象属性当前值。
</pre>
<p><br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/p/r/Spring_Framework_Validation_26d6.html" title="Spring Framework Validation">编辑</a>]</div><a name="scholar.E9.85.8D.E7.BD.AE.E6.96.B9.E5.BC.8F"></a><h2>scholar配置方式</h2>
<p>１．新建一个applicationContextValidator.xml文件，和其他的分开，这样更加清晰，也可以不分开直接在action.xml
　中添入所需要的ｂｅａｎ．
</p><p><br />
2．在配置文件当中配置一个ｂｅａｎ做为我们具体验证数据的类，并且设置验证类相关的属性－如
</p><p>userManager为RegisterValidator验证类的一个属性
</p><p>&lt;bean id="registerValidator" class="org.scholar.validator.RegisterValidator"&gt;
	&lt;property name="userManager" ref="userManager" /&gt;
&lt;/bean&gt;
</p><p><br />
3.在applicationContext-action.xml中的userAction（在此之拿userAction做例子）中设置相关的映射
</p><p>&lt;property name="validatorMappings"&gt;
	&lt;props&gt;
		&lt;prop key="register"&gt;registerValidator&lt;/prop&gt;
		&lt;prop key="updateUser"&gt;updateUserValidator&lt;/prop&gt;
	&lt;/props&gt;
&lt;/property&gt;
</p><p><br />
其中可以给userAction中的任何需要数据验证的方法写一个Validator，如上register方法registerValidator。
</p><p><br />
4.我么可以基类如－BaseActionController，
public class BaseActionController extends MultiActionController {　.........｝
</p><p>在这个类里面要完成的相关东作如下: 
</p><p><br />
</p>
<ul><li>private Map validatorMappings = new HashMap();
</li></ul>
<p>public void setValidatorMappings(Properties mappings) {
		this.validatorMappings.putAll(mappings);
}
</p><p>这里主要完成对applicationContext-action.xml里面写入的相关信息注入到这里，
这里将我们在applicationContext-action.xml的的userAction中validatorMappings
的资源（每一个映射）都保存在一个hashMap集合变量中。
</p><p><br />
</p>
<ul><li>然后写我们具体需要数据验证的一个方法
</li></ul>
<p>protected Errors sBind(ServletRequest request, Object command, String method) throws Exception {
		logger.debug("Binding request parameters onto MultiActionController command");
		ServletRequestDataBinder binder = createBinder(request, command);
		binder.bind(request);
		Errors errors = binder.getErrors();
</p><p><br />		
		Validator validator = null;
		Object value = validatorMappings.get(method);
		if (value&nbsp;!= null &amp;&amp; value instanceof String) {
			String validatorName = (String) value;
			if (getApplicationContext().isSingleton(validatorName)) {
				validator = (Validator)getApplicationContext().getBean(validatorName);
			}
		}
</p><p><br />		
		if(validator&nbsp;!= null){
			ValidationUtils.invokeValidator(validator, command,errors);
		}
		return errors;
	}
</p><p>在下面这段先将request中的数据邦定到我们具体需要验证的实体类中，
ServletRequestDataBinder binder = createBinder(request, command);
		binder.bind(request);
		Errors errors = binder.getErrors();
</p><p>这里主要进行类中相关字段的匹配，即request中相关的字段和我们的实体类中相关的字段匹配，如果不匹配
就会跑出错误．
</p><p><br />
剩下的就是我们该执行我们具体的验证类了
Validator validator = null;
		Object value = validatorMappings.get(method);
		if (value&nbsp;!= null &amp;&amp; value instanceof String) {
			String validatorName = (String) value;
			if (getApplicationContext().isSingleton(validatorName)) {
				validator = (Validator)getApplicationContext().getBean(validatorName);
</p><p>这里先通过hashMap变量，取出我们需要的键对，用validatorMappings.get(mehhod)取出需要执行的验证
</p><p>类，这里的method就是我们的action 中需要数据验证的具体方法，如传入的方法register　对应
</p><p>registerValidator验证类，在这里取出的只是对应的字符串，然后我们通过
</p><p>getApplicationContext().getBean(validatorName)方法取出我们在配置文件当中配置的相关的验证类，
在此就获得了数据验证的类，现在已经成功９９％了．
</p>
<ul><li>最后就是该具体的执行我们的验证类了，如下：
</li></ul>
<p>if(validator&nbsp;!= null){
</p><p>　　　ValidationUtils.invokeValidator(validator, command,errors);
</p><p>}
</p><p>return errors;
</p><p>这里的方法ValidationUtils.invokeValidator(validator, command,errors);就是具体的区执行我们的数据
</p><p>验证类，如果想知道.invokeValidator（）的具体执行过程，可以找源码看．
</p><p>只要数据验证类写好，就可以100％了.
</p>
<div class="printfooter">
<p>取自"<a href="http://dns.cs.hit.edu.cn../../../s/p/r/Spring_Framework_Validation_26d6.html">http://dns.cs.hit.edu.cn../../../s/p/r/Spring_Framework_Validation_26d6.html</a>"</p>

<p>本页面已经被浏览14次。 This page was last modified 13:05 2006年8月4日 by <a href="../../../m/y/q/User%7EMyqhit.html" class="new" title="User:Myqhit">马玉清</a>. Based on work by <a href="../../../c/a/o/User%7ECaoliang.html" title="User:Caoliang">曹亮</a>. </p>
</div>

</div><br style="clear:both" />

<div id='footer'><table border="0" cellspacing="0"><tr><td width='152' rowspan='1'>&nbsp;</td><td class='bottom' align='left' valign='top'><strong><a href="../../../s/p/r/Spring_Framework_Validation_26d6.html" title="Spring Framework Validation">编辑本页</a></strong> |
<a href="../../../s/p/r/Talk%7ESpring_Framework_Validation_ea99.html" class="new" title="Talk:Spring Framework Validation">讨论本页</a> |
<a href="../../../s/p/r/Spring_Framework_Validation_26d6.html" title="Spring Framework Validation">较早版本</a> |
<a href="../../../w/h/a/Special%7EWhatlinkshere.html" title="Special:Whatlinkshere">链入页面</a> |
<a href="../../../r/e/c/Special%7ERecentchangeslinked.html" title="Special:Recentchangeslinked">链出更改</a>
<br /><br />

<br /><a href="../../../index.html" title="首页">首页</a> | <a href="../../../w/i/k/Wikipedia%7E%E5%85%B3%E4%BA%8E.html" title="Wikipedia:关于">关于Wikipedia</a> | <a href="../../../r/e/c/Special%7ERecentchanges.html" title="Special:Recentchanges">最近更改</a> | <form name="search" class="inline" method="post" action="../../../s/e/a/Special%7ESearch.html">
<input type="text" name="search" size="19" value="" />
<input type="submit" name="go" value="进入" />&nbsp;<input type="submit" name="fulltext" value="搜索" />
</form><br /><span id="pagestats">本页面已经被浏览14次。 This page was last modified 13:05 2006年8月4日 by <a href="../../../m/y/q/User%7EMyqhit.html" class="new" title="User:Myqhit">马玉清</a>. Based on work by <a href="../../../c/a/o/User%7ECaoliang.html" title="User:Caoliang">曹亮</a>. </span></td></tr></table>
</div>
</div>

<div id='quickbar'>
<a href='../../../index.html'><img src='../../../../skins/common/images/wiki.jpg' alt='[首页]' /></a>
<hr class='sep' /><a href="../../../index.html">首页</a>
<br /><a href="../../../c/o/m/WIKI-HIT_IBM_CLUB%7ECommunity_Portal_9150.html">社区</a>
<br /><a href="../../../c/u/r/Current_events.html">新闻动态</a>
<br /><a href="../../../r/e/c/Special%7ERecentchanges.html">最近更改</a>
<br /><a href="../../../r/a/n/Special%7ERandom.html">随机页面</a>
<br /><a href="../../../w/i/k/Wikipedia%7E%E5%B8%AE%E5%8A%A9.html">帮助</a>
<br /><a href="../../../s/i/t/WIKI-HIT_IBM_CLUB%7ESite_support.html">Donations</a>
<br />
<hr class='sep' /><strong><a href="../../../s/p/r/Spring_Framework_Validation_26d6.html" title="Spring Framework Validation">编辑本页</a></strong>
<br /><a href="../../../s/p/r/Talk%7ESpring_Framework_Validation_ea99.html" class="new" title="Talk:Spring Framework Validation">讨论本页</a>
<br /><a href="../../../s/p/r/Spring_Framework_Validation_26d6.html" title="Spring Framework Validation">较早版本</a>
<br /><a href="../../../w/h/a/Special%7EWhatlinkshere.html" title="Special:Whatlinkshere">链入页面</a>
<br /><a href="../../../r/e/c/Special%7ERecentchangeslinked.html" title="Special:Recentchangeslinked">链出更改</a>
<br /><hr class='sep' /><a href="../../../s/p/e/Special%7ESpecialpages.html" title="Special:Specialpages">特殊页面</a>
<br /><a href="../../../w/i/k/Wikipedia%7E%E9%94%99%E8%AF%AF%E6%8A%A5%E5%91%8A.html" title="Wikipedia:错误报告">错误报告</a>
<br /></div>
<!-- Served by dns.cs.hit.edu.cn in 1351392862.45 secs. -->
</body></html>