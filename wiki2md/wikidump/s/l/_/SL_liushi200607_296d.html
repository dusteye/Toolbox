<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-cn" lang="zh-cn" >
<head>
<title>SL liushi200607 - WIKI-HIT IBM CLUB</title>
<meta name="KEYWORDS" content="首页,ALP,Address,Android,Android Newbie Guide,Android Project Development,Android Research Field,Android Third Party Lib And Tool,BoardGame,CSAPP" />
<meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
<meta name="robots" content="index,follow" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel='stylesheet' type='text/css' media='print' href='../../../../skins/common/wikiprintable.css' />
<script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
<style type='text/css'>
/*/*/ /*<![CDATA[*/
@import "../../../../skins/common/wikistandard.css";
@import "../../../s/t/a/MediaWiki%7EStandard.css.html";
a.new, #quickbar a.new { color: #CC2200; }
.editsection { display: none; }
#quickbar { position: absolute; top: 4px; left: 4px; border-right: 1px solid gray; }
#article { margin-left: 152px; margin-right: 4px; }

/*]]>*/ /* */
</style>
</head>

<body bgcolor='#FFFFFF' onload=''>

<div id='content'>
<div id='topbar'>
<table border='0' cellspacing='0' width='98%'>
<tr>
<td width='152' rowspan='1'>&nbsp;</td><td class="top" align='left' valign='top'>
<a href="../../../index.html" title="首页">首页</a> |
<a href="../../../r/e/c/Special%7ERecentchanges.html" title="Special:Recentchanges">最近更改</a> |
<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑本页</a> |
<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">较早版本</a><p class='subtitle'><a href="../../../s/l/_/SL_liushi200607_296d.html">可打印版</a> | <a href="../../../g/e/n/WIKI-HIT_IBM_CLUB%7EGeneral_disclaimer.html" title="WIKI-HIT IBM CLUB:General disclaimer">Disclaimers</a></p>
</td>
<td class="top" valign='top' align='right' nowrap='nowrap'>Not logged in
<br /><a href="../../../u/s/e/Special%7EUserlogin.html" title="Special:Userlogin">登录</a> | <a href="../../../w/i/k/Wikipedia%7E%E5%B8%AE%E5%8A%A9.html" title="Wikipedia:帮助">帮助</a>
<br /><form name="search" class="inline" method="post" action="../../../s/e/a/Special%7ESearch.html">
<input type="text" name="search" size="19" value="" />
<input type="submit" name="go" value="进入" />&nbsp;<input type="submit" name="fulltext" value="搜索" />
</form></td></tr>
</table>
</div>

<div id='article'>
<h1 class="pagetitle">SL liushi200607</h1><p class='subtitle'>Wikipedia，自由的百科全书</p>
<table id='toc' class='toc'><tr><td><div id='toctitle'><h2>目录</h2></div>
<ul>
<li class='toclevel-1'><a href="#7.E6.9C.8815.E6.97.A5"><span class="tocnumber">1</span> <span class="toctext">7月15日</span></a></li>
<li class='toclevel-1'><a href="#7.E6.9C.8816.E6.97.A5"><span class="tocnumber">2</span> <span class="toctext">7月16日</span></a></li>
<li class='toclevel-1'><a href="#7.E6.9C.8818.E6.97.A5"><span class="tocnumber">3</span> <span class="toctext">7月18日</span></a></li>
<li class='toclevel-1'><a href="#7.E6.9C.8819.E6.97.A5"><span class="tocnumber">4</span> <span class="toctext">7月19日</span></a></li>
<li class='toclevel-1'><a href="#7.E6.9C.8821.7E24.E6.97.A5"><span class="tocnumber">5</span> <span class="toctext">7月21~24日</span></a></li>
<li class='toclevel-1'><a href="#7.E6.9C.8831.E6.97.A5.EF.BC.88.E4.B8.83.E5.A4.95.E5.89.8D.E5.A4.9C.EF.BC.89"><span class="tocnumber">6</span> <span class="toctext">7月31日（七夕前夜）</span></a></li>
<li class='toclevel-1'><a href="#8.E6.9C.881.E6.97.A5"><span class="tocnumber">7</span> <span class="toctext">8月1日</span></a>
<ul>
<li class='toclevel-2'><a href="#Two_Session"><span class="tocnumber">7.1</span> <span class="toctext">Two Session</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="#8.E6.9C.884.E6.97.A5"><span class="tocnumber">8</span> <span class="toctext">8月4日</span></a></li>
</ul>
</td></tr></table>
<p><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "显示"; var tocHideText = "隐藏"; showTocToggle(); } </script>
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑</a>]</div><a name="7.E6.9C.8815.E6.97.A5"></a><h2>7月15日</h2>
<p>JUnit范例阅读分析
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑</a>]</div><a name="7.E6.9C.8816.E6.97.A5"></a><h2>7月16日</h2>
<p>计划：Hibernate再学习
</p><p>看了Matrix上的关于Hibernate的介绍,又读了一下cowoo的配置文件,有了些概况认识了.
</p>
<ol><li>PO:（Persistent Object）持久化对象。看了<a href="http://www.volitation.net/Article/print.asp?SelectID=7" class='external text' title="http://www.volitation.net/Article/print.asp?SelectID=7" rel="nofollow">什么是持久化对象</a>，对Hibernate第一次有了比较明确的认识。（14：01）
</li><li>用自己的话说：Hibernate就是为了把对象的行为与数据库和程序间的数据交互进行分离，先由各种接口定义对象的行为，再由这些接口对应的实现类来实现行为，在Hibernate配置文件中配置这些实现类，之后这些接口就可以像实体类一样使用，而它的代码实现是由配置文件里注册的实现类来承担的。
</li><li>这种实现的好处：接口类可以用于抽象的定义对象可以拥有的行为，不用考虑具体实现。而实现类与接口类的连接关系是通过xml配置文件及接口implements绑定的，不需要改变代码就可以换用不同的具体实现类，只需要修改配置文件即可。
</li><li>再取其本质，就是在代码中定义使用接口类，在配置文件中决定这个接口类由哪个实现了该接口的具体类来替换。（14：28）
</li><li>现在感觉对Hibernate又不太清楚了，DAO应该是spring里的东西。
</li><li>ft，看来概念也要一遍一遍重构。
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑</a>]</div><a name="7.E6.9C.8818.E6.97.A5"></a><h2>7月18日</h2>
<pre>Mock的使用
</pre>
<p>参考资料:<a href="http://www.blogjava.net/ghawk/archive/2005/12/15/24060.html" class='external text' title="http://www.blogjava.net/ghawk/archive/2005/12/15/24060.html" rel="nofollow">EasyMock 2.0_ReleaseCandidate 文档翻译</a>
</p><p>基本原理这里讲的很清楚，即先是Mock“彩排”，不真正进行动作，只记录需要模拟的操作种类和数量，之后replay（mock）；然后是真正的测试过程，其中应该有之前彩排的动作发生，之后可以用verify()来验证之前的规定动作是否发生。
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑</a>]</div><a name="7.E6.9C.8819.E6.97.A5"></a><h2>7月19日</h2>
<pre>Mock的问题
</pre>
<p>又是Mock，今天博士想增加UserRelationManagerTest里面的测试代码，因为原来我写的确实没有用assert,fail之类的来测试执行效果，只是调用一下，没有Exception就算过了。但是增加了检测就发现问题出现了，应为Test的setUp方法中建立了Mock的对象，即使后面的测试方法里看似没有用到Mock，它还是会经过一层Mock的封装，直接导致debug的时候不能跟到DaoHibernate那层，而是要先经过一层Mock的东西，没有加载Mock的源代码，所以跟不进去，看不到过程。只知道本应该正确的测试，返回了Null对象。
</p><p>但是另一方面，UserRelationDaoTest和UserRelationActionTest都可以顺利过去（没有用到Mock），web使用也可以正常，看来是对Mock了解不够。
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑</a>]</div><a name="7.E6.9C.8821.7E24.E6.97.A5"></a><h2>7月21~24日</h2>
<p><a href="../../../e/a/s/EasyMock_89d9.html" title="EasyMock">EasyMock学习笔记</a>
</p><p><a href="../../../e/a/s/EasyMock%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E_5a8e.html" title="EasyMock使用说明">EasyMock使用说明</a>
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑</a>]</div><a name="7.E6.9C.8831.E6.97.A5.EF.BC.88.E4.B8.83.E5.A4.95.E5.89.8D.E5.A4.9C.EF.BC.89"></a><h2>7月31日（七夕前夜）</h2>
<p>问题：Transaction has been rolled back because it has been marked as rollback-only
提示：
</p>
<pre> [springsample] 2006-07-31 19:41:15,390 - org.springframework.transaction.interceptor.RuleBasedTransactionAttribute -14047 [main] DEBUG org.springframework.transaction.interceptor.RuleBasedTransactionAttribute  - Applying rules to determine whether transaction should rollback on org.springframework.dao.DataRetrievalFailureException: UserDaoHibernate.getUserByMail() failed. email = lianggo@gmail.com
 [springsample] 2006-07-31 19:41:15,390 - org.springframework.transaction.interceptor.RuleBasedTransactionAttribute -14047 [main] DEBUG org.springframework.transaction.interceptor.RuleBasedTransactionAttribute  - Winning rollback rule is: null
 [springsample] 2006-07-31 19:41:15,390 - org.springframework.transaction.interceptor.RuleBasedTransactionAttribute -14047 [main] DEBUG org.springframework.transaction.interceptor.RuleBasedTransactionAttribute  - No relevant rollback rule found: applying superclass default
 [springsample] 2006-07-31 19:41:15,390 - org.springframework.transaction.interceptor.TransactionInterceptor -14047 [main] DEBUG org.springframework.transaction.interceptor.TransactionInterceptor  - Invoking rollback for transaction on org.scholar.service.IUserManager.getUserByEmail due to throwable [org.springframework.dao.DataRetrievalFailureException: UserDaoHibernate.getUserByMail() failed. email = lianggo@gmail.com]
 [springsample] 2006-07-31 19:41:15,390 - org.springframework.orm.hibernate3.HibernateTransactionManager -14047 [main] DEBUG org.springframework.orm.hibernate3.HibernateTransactionManager  - Participating transaction failed - marking existing transaction as rollback-only
 [springsample] 2006-07-31 19:41:15,390 - org.springframework.orm.hibernate3.HibernateTransactionManager -14047 [main] DEBUG org.springframework.orm.hibernate3.HibernateTransactionManager  - Setting Hibernate transaction on Session [org.hibernate.impl.SessionImpl@1980630] rollback-only
</pre>
<p>原因：前面通过getUserByEmail来判断是否已经注册，但是这时候Spring会自动将该transaction设置为rollback-only，使得不能正常test
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑</a>]</div><a name="8.E6.9C.881.E6.97.A5"></a><h2>8月1日</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑</a>]</div><a name="Two_Session"></a><h3>Two Session</h3>
<p>spring开发者对不能同时开启两个以上的session的说明：
</p>
<pre>Of course, you usually shouldn't have many transactions per request, so the number of Sessions kept
open should be very small - hardly ever more than 2. The only effect to pay attention to here is 
that you cannot load an object in one transaction and save it in another, as both Sessions will 
still be open... (A persistent object should only be associated with one Session at the same time.)
</pre>
<p>当先get某个对象时（没有结束事务），再save它就会出问题。
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑</a>]</div><a name="8.E6.9C.884.E6.97.A5"></a><h2>8月4日</h2>
<pre>bug：
1、新发起topic后，点击按照clicks等排序或刷新页面会自动地重发帖。
    原因：displaytag会保留原始的参数，使排序顺带重新提交过程
2、home上的new message还不是新的邮件数量，而是总数量 
    原因：还没有message未读的数据库项，暂时没改
</pre>
<div class="printfooter">
<p>取自"<a href="http://dns.cs.hit.edu.cn../../../s/l/_/SL_liushi200607_296d.html">http://dns.cs.hit.edu.cn../../../s/l/_/SL_liushi200607_296d.html</a>"</p>

<p>本页面已经被浏览32次。 This page was last modified 07:47 2006年8月4日 by <a href="../../../d/y/i/User%7EDyingcow.html" title="User:Dyingcow">刘奭</a>.  </p>
</div>

</div><br style="clear:both" />

<div id='footer'><table border="0" cellspacing="0"><tr><td width='152' rowspan='1'>&nbsp;</td><td class='bottom' align='left' valign='top'><strong><a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑本页</a></strong> |
<a href="../../../s/l/_/Talk%7ESL_liushi200607_9f36.html" class="new" title="Talk:SL liushi200607">讨论本页</a> |
<a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">较早版本</a> |
<a href="../../../w/h/a/Special%7EWhatlinkshere.html" title="Special:Whatlinkshere">链入页面</a> |
<a href="../../../r/e/c/Special%7ERecentchangeslinked.html" title="Special:Recentchangeslinked">链出更改</a>
<br /><br />

<br /><a href="../../../index.html" title="首页">首页</a> | <a href="../../../w/i/k/Wikipedia%7E%E5%85%B3%E4%BA%8E.html" title="Wikipedia:关于">关于Wikipedia</a> | <a href="../../../r/e/c/Special%7ERecentchanges.html" title="Special:Recentchanges">最近更改</a> | <form name="search" class="inline" method="post" action="../../../s/e/a/Special%7ESearch.html">
<input type="text" name="search" size="19" value="" />
<input type="submit" name="go" value="进入" />&nbsp;<input type="submit" name="fulltext" value="搜索" />
</form><br /><span id="pagestats">本页面已经被浏览32次。 This page was last modified 07:47 2006年8月4日 by <a href="../../../d/y/i/User%7EDyingcow.html" title="User:Dyingcow">刘奭</a>.  </span></td></tr></table>
</div>
</div>

<div id='quickbar'>
<a href='../../../index.html'><img src='../../../../skins/common/images/wiki.jpg' alt='[首页]' /></a>
<hr class='sep' /><a href="../../../index.html">首页</a>
<br /><a href="../../../c/o/m/WIKI-HIT_IBM_CLUB%7ECommunity_Portal_9150.html">社区</a>
<br /><a href="../../../c/u/r/Current_events.html">新闻动态</a>
<br /><a href="../../../r/e/c/Special%7ERecentchanges.html">最近更改</a>
<br /><a href="../../../r/a/n/Special%7ERandom.html">随机页面</a>
<br /><a href="../../../w/i/k/Wikipedia%7E%E5%B8%AE%E5%8A%A9.html">帮助</a>
<br /><a href="../../../s/i/t/WIKI-HIT_IBM_CLUB%7ESite_support.html">Donations</a>
<br />
<hr class='sep' /><strong><a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">编辑本页</a></strong>
<br /><a href="../../../s/l/_/Talk%7ESL_liushi200607_9f36.html" class="new" title="Talk:SL liushi200607">讨论本页</a>
<br /><a href="../../../s/l/_/SL_liushi200607_296d.html" title="SL liushi200607">较早版本</a>
<br /><a href="../../../w/h/a/Special%7EWhatlinkshere.html" title="Special:Whatlinkshere">链入页面</a>
<br /><a href="../../../r/e/c/Special%7ERecentchangeslinked.html" title="Special:Recentchangeslinked">链出更改</a>
<br /><hr class='sep' /><a href="../../../s/p/e/Special%7ESpecialpages.html" title="Special:Specialpages">特殊页面</a>
<br /><a href="../../../w/i/k/Wikipedia%7E%E9%94%99%E8%AF%AF%E6%8A%A5%E5%91%8A.html" title="Wikipedia:错误报告">错误报告</a>
<br /></div>
<!-- Served by dns.cs.hit.edu.cn in 1351392829.51 secs. -->
</body></html>