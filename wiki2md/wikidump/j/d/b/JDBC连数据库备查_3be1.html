<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-cn" lang="zh-cn" >
<head>
<title>JDBC连数据库备查 - WIKI-HIT IBM CLUB</title>
<meta name="KEYWORDS" content="首页,ALP,Address,Android,Android Newbie Guide,Android Project Development,Android Research Field,Android Third Party Lib And Tool,BoardGame,CSAPP" />
<meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
<meta name="robots" content="index,follow" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel='stylesheet' type='text/css' media='print' href='../../../../skins/common/wikiprintable.css' />
<script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
<style type='text/css'>
/*/*/ /*<![CDATA[*/
@import "../../../../skins/common/wikistandard.css";
@import "../../../s/t/a/MediaWiki%7EStandard.css.html";
a.new, #quickbar a.new { color: #CC2200; }
.editsection { display: none; }
#quickbar { position: absolute; top: 4px; left: 4px; border-right: 1px solid gray; }
#article { margin-left: 152px; margin-right: 4px; }

/*]]>*/ /* */
</style>
</head>

<body bgcolor='#FFFFFF' onload=''>

<div id='content'>
<div id='topbar'>
<table border='0' cellspacing='0' width='98%'>
<tr>
<td width='152' rowspan='1'>&nbsp;</td><td class="top" align='left' valign='top'>
<a href="../../../index.html" title="首页">首页</a> |
<a href="../../../r/e/c/Special%7ERecentchanges.html" title="Special:Recentchanges">最近更改</a> |
<a href="../../../j/d/b/JDBC%E8%BF%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E6%9F%A5_3be1.html" title="JDBC连数据库备查">编辑本页</a> |
<a href="../../../j/d/b/JDBC%E8%BF%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E6%9F%A5_3be1.html" title="JDBC连数据库备查">较早版本</a><p class='subtitle'><a href="../../../j/d/b/JDBC%E8%BF%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E6%9F%A5_3be1.html">可打印版</a> | <a href="../../../g/e/n/WIKI-HIT_IBM_CLUB%7EGeneral_disclaimer.html" title="WIKI-HIT IBM CLUB:General disclaimer">Disclaimers</a></p>
</td>
<td class="top" valign='top' align='right' nowrap='nowrap'>Not logged in
<br /><a href="../../../u/s/e/Special%7EUserlogin.html" title="Special:Userlogin">登录</a> | <a href="../../../w/i/k/Wikipedia%7E%E5%B8%AE%E5%8A%A9.html" title="Wikipedia:帮助">帮助</a>
<br /><form name="search" class="inline" method="post" action="../../../s/e/a/Special%7ESearch.html">
<input type="text" name="search" size="19" value="" />
<input type="submit" name="go" value="进入" />&nbsp;<input type="submit" name="fulltext" value="搜索" />
</form></td></tr>
</table>
</div>

<div id='article'>
<h1 class="pagetitle">JDBC连数据库备查</h1><p class='subtitle'>Wikipedia，自由的百科全书</p>
<p>这是一篇基础性文章，主要介绍了jdbc在流行数据库(sql server,oracle)方面的应用。但是都是个人观点，所以不能保证完全正确，仅供参考，如果有不同意见可以在评论中指出，我会做相应的修改。:)
一般情况下,直接用jdbc等东西连数据库时,比较常用连数据库的代码可能是:
</p>
<pre>private Connection conn
private String poolURL = "";
private String driverName ="";
private String user=""
private String pass="";
private DBConnProxy Proxy; //自己写的class,起控制数据库访问作用
public Object getConn()
{
try
{
Properties prop=new Properties();
prop.setProperty("user",user);
prop.setProperty("password",pass);
Driver mydriver=(Driver)Class.forName(driverName).newInstance();
conn = mydriver.connect(poolURL,prop);//或者conn = mydriver.connect(poolURL,  null);具体什么时候用我还的请教高手。
/*
或者:
Class.forName(driverName);
conn=DriverManager.getConnection(poolURL, user, pass);
*/
}
catch ( Exception e )
{
System.out.println("打开数据库出错\n" + e.getMessage());
}
</pre>
<pre>if(!Proxy.getDB() ){
this.Close()
return null;
}
</pre>
<pre>return conn;
}
</pre>
<p>其中的 driverName,poolURL,user,pass都可以通过读取 xml文件或普通属性文件获取。而是连sqlserver还是oracle就只是改改配置就可以了。
</p><p><br />
它们都可以用 sun.jdbc.odbc.JdbcOdbcDriver 来连。对应poolURL="jdbc:odbc:test",user,pass略
</p><p><br />
也可以用自己特有的:
</p><p>sqlserver:weblogic.jdbc.mssqlserver4.Driver (网上下) 对应poolURL="jdbc:weblogic:mssqlserver4:ceic@127.0.0.1" //ceic是数据库名，127.0.0.1是数据源位置,可以是远程的数据库,user,pass略
</p><p>oracle:oracle.jdbc.driver.OracleDriver (class12.zip,装了oracle就应该有了) 对应jdbc:oracle:thin:scott/tiger@10.1.103.234:1521:sp" scott/tiger连接身份的用户名/密码,10.1.103.234,数据源ip,1521:端口(默认是1521). sp指向数据库名user,pass略
</p><p><br />
如果用的weblogic配的数据库连接，可以通过
</p>
<pre>Context ctx = new InitialContext();
DataSource ds = (DataSource)ctx.lookup("forceicdatasource"); //forceicdatasource是配的datasource.也可以通过和上面统一的方法来调用。
weblogic:weblogic.jdbc.pool.Driver //driverName
</pre>
<p>对应的poolURL="jdbc:weblogic:pool:poolname" //poolname是在weblogic中配的jdbc类型的connections pool的名字。user,pass是weblogic用户（administrators用户组中的用户）的用户名和密码。(如果不是用 DriverManager就用不上，"conn = mydriver.connect(poolURL,null);"就是在这种情况下可以用。我在weblogic 6.1下测试通过)
</p><p><br />
综上说的，可以看出，大多数数据库连接都可以通过配置 属性文件 来灵活的获取。（移植起来很是方便，并且对应用基本没有什么影响，当然也可以夸平台)所以我可以通过动态读取属性文件来解决。
</p>
<pre>private String javaHome = System.getProperty("java.home");
private final String FS = System.getProperty("file.separator");
private String path = javaHome+FS+"db.properties"; //把db.properties放在系统属性java.home下，一般是jdk目录下的 jre目录里。
public boolean getInfo(){
File file=new java.io.File(path);
Properties pro=new Properties();
boolean readsucced;
try{
InputStream in=new BufferedInputStream(new FileInputStream(file));
pro.load(in);
driverName=pro.getProperty("driverName");
poolURL=pro.getProperty("poolURL")&nbsp;;
user=pro.getProperty("user")&nbsp;;
pass=pro.getProperty("pass")&nbsp;;
//自己把它们trim()掉。我就偷懒不写了。
readsucced=true;
}catch(Exception e){System.out.println("读取属性文件出错");readsucced=false;}
return readsucced;
}
</pre>
<p><br />
不过一般只用读一次就可以了。所以可以把它放在 static{}块里，也可以放在构造器里面(然后和放在静态连接池，如果是单独的应用，应该把getInfo()作为静态类和数据库连接类分开)。
</p>
<pre>public DBConn() {
setDBConnProxy(ProxyFactory.DefaultType );//设定连接proxy,控制数据库连接频率，可能会牺牲效力，不过在防止恶意破坏上有点作用，自己写的毕竟赶不上weblogic的连接池了。所以只好做点小的防范措施.如果是用weblogic配的连接池，可以直接在proxyFactory里面加个什么都不做的proxy.
getInfo();
}
</pre>
<p>属性文件db.properties内容如下:
</p>
<pre>driverName=sun.jdbc.odbc.JdbcOdbcDriver
poolURL=jdbc:odbc:test
user=sa
pass=1234Q_Q5678
</pre>
<p>自己可以耕具实际情况去更改属性文件。
</p><p>注: getConn()方法返回的是 Object,是不同的数据库连接有不同的扩展应用，比如oracle的就有针对clob,blob的应用（用class12.zip的情况下），普通的 connection不能满足,所以可以通过在应用中把getConn()返回的Object转化成OracleConnection来用。（个人观点，不知道有没有更好的解决方法）
上面写的这么多，可能只对新手有点用处，在j2ee风行的今天已经很落伍了，还希望高手指出问题一起讨论(还没有有关于mysql的连接办法，没有做过，希望有人能补充上来)。
</p><p><br />
</p>
<hr />
<p>MySQL数据库驱动
</p>
<pre>driverName=com.mysql.jdbc.Driver
poolURL=jdbc:mysql://127.0.0.1:3306/test
</pre>
<p>SQL Server数据库驱动
</p>
<pre>driverName=com.microsoft.jdbc.sqlserver.SQLServerDriver
poolURL=jdbc:microsoft:sqlserver://127.0.0.1:1433;databaseName=test
</pre>
<div class="printfooter">
<p>取自"<a href="http://dns.cs.hit.edu.cn../../../j/d/b/JDBC%E8%BF%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E6%9F%A5_3be1.html">http://dns.cs.hit.edu.cn../../../j/d/b/JDBC%E8%BF%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E6%9F%A5_3be1.html</a>"</p>

<p>本页面已经被浏览17次。 This page was last modified 12:09 2006年5月26日 by <a href="../../../c/o/w/User%7ECowoo.html" title="User:Cowoo">陈伟</a>.  </p>
</div>

</div><br style="clear:both" />

<div id='footer'><table border="0" cellspacing="0"><tr><td width='152' rowspan='1'>&nbsp;</td><td class='bottom' align='left' valign='top'><strong><a href="../../../j/d/b/JDBC%E8%BF%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E6%9F%A5_3be1.html" title="JDBC连数据库备查">编辑本页</a></strong> |
<a href="../../../j/d/b/Talk%7EJDBC%E8%BF%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E6%9F%A5_ae3e.html" class="new" title="Talk:JDBC连数据库备查">讨论本页</a> |
<a href="../../../j/d/b/JDBC%E8%BF%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E6%9F%A5_3be1.html" title="JDBC连数据库备查">较早版本</a> |
<a href="../../../w/h/a/Special%7EWhatlinkshere.html" title="Special:Whatlinkshere">链入页面</a> |
<a href="../../../r/e/c/Special%7ERecentchangeslinked.html" title="Special:Recentchangeslinked">链出更改</a>
<br /><br />

<br /><a href="../../../index.html" title="首页">首页</a> | <a href="../../../w/i/k/Wikipedia%7E%E5%85%B3%E4%BA%8E.html" title="Wikipedia:关于">关于Wikipedia</a> | <a href="../../../r/e/c/Special%7ERecentchanges.html" title="Special:Recentchanges">最近更改</a> | <form name="search" class="inline" method="post" action="../../../s/e/a/Special%7ESearch.html">
<input type="text" name="search" size="19" value="" />
<input type="submit" name="go" value="进入" />&nbsp;<input type="submit" name="fulltext" value="搜索" />
</form><br /><span id="pagestats">本页面已经被浏览17次。 This page was last modified 12:09 2006年5月26日 by <a href="../../../c/o/w/User%7ECowoo.html" title="User:Cowoo">陈伟</a>.  </span></td></tr></table>
</div>
</div>

<div id='quickbar'>
<a href='../../../index.html'><img src='../../../../skins/common/images/wiki.jpg' alt='[首页]' /></a>
<hr class='sep' /><a href="../../../index.html">首页</a>
<br /><a href="../../../c/o/m/WIKI-HIT_IBM_CLUB%7ECommunity_Portal_9150.html">社区</a>
<br /><a href="../../../c/u/r/Current_events.html">新闻动态</a>
<br /><a href="../../../r/e/c/Special%7ERecentchanges.html">最近更改</a>
<br /><a href="../../../r/a/n/Special%7ERandom.html">随机页面</a>
<br /><a href="../../../w/i/k/Wikipedia%7E%E5%B8%AE%E5%8A%A9.html">帮助</a>
<br /><a href="../../../s/i/t/WIKI-HIT_IBM_CLUB%7ESite_support.html">Donations</a>
<br />
<hr class='sep' /><strong><a href="../../../j/d/b/JDBC%E8%BF%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E6%9F%A5_3be1.html" title="JDBC连数据库备查">编辑本页</a></strong>
<br /><a href="../../../j/d/b/Talk%7EJDBC%E8%BF%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E6%9F%A5_ae3e.html" class="new" title="Talk:JDBC连数据库备查">讨论本页</a>
<br /><a href="../../../j/d/b/JDBC%E8%BF%9E%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%87%E6%9F%A5_3be1.html" title="JDBC连数据库备查">较早版本</a>
<br /><a href="../../../w/h/a/Special%7EWhatlinkshere.html" title="Special:Whatlinkshere">链入页面</a>
<br /><a href="../../../r/e/c/Special%7ERecentchangeslinked.html" title="Special:Recentchangeslinked">链出更改</a>
<br /><hr class='sep' /><a href="../../../s/p/e/Special%7ESpecialpages.html" title="Special:Specialpages">特殊页面</a>
<br /><a href="../../../w/i/k/Wikipedia%7E%E9%94%99%E8%AF%AF%E6%8A%A5%E5%91%8A.html" title="Wikipedia:错误报告">错误报告</a>
<br /></div>
<!-- Served by dns.cs.hit.edu.cn in 1351392717.67 secs. -->
</body></html>