<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-cn" lang="zh-cn" >
<head>
<title>Talk:ProxyProject - WIKI-HIT IBM CLUB</title>
<meta name="KEYWORDS" content="首页,ALP,Address,Android,Android Newbie Guide,Android Project Development,Android Research Field,Android Third Party Lib And Tool,BoardGame,CSAPP" />
<meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
<meta name="robots" content="index,follow" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel='stylesheet' type='text/css' media='print' href='../../../../skins/common/wikiprintable.css' />
<script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
<style type='text/css'>
/*/*/ /*<![CDATA[*/
@import "../../../../skins/common/wikistandard.css";
@import "../../../s/t/a/MediaWiki%7EStandard.css.html";
a.new, #quickbar a.new { color: #CC2200; }
.editsection { display: none; }
#quickbar { position: absolute; top: 4px; left: 4px; border-right: 1px solid gray; }
#article { margin-left: 152px; margin-right: 4px; }

/*]]>*/ /* */
</style>
</head>

<body bgcolor='#ffffec' onload=''>

<div id='content'>
<div id='topbar'>
<table border='0' cellspacing='0' width='98%'>
<tr>
<td width='152' rowspan='1'>&nbsp;</td><td class="top" align='left' valign='top'>
<a href="../../../index.html" title="首页">首页</a> |
<a href="../../../r/e/c/Special%7ERecentchanges.html" title="Special:Recentchanges">最近更改</a> |
<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑本页</a> |
<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">较早版本</a><p class='subtitle'><a href="../../../p/r/o/Talk%7EProxyProject_cd63.html">可打印版</a> | <a href="../../../g/e/n/WIKI-HIT_IBM_CLUB%7EGeneral_disclaimer.html" title="WIKI-HIT IBM CLUB:General disclaimer">Disclaimers</a></p>
</td>
<td class="top" valign='top' align='right' nowrap='nowrap'>Not logged in
<br /><a href="../../../u/s/e/Special%7EUserlogin.html" title="Special:Userlogin">登录</a> | <a href="../../../w/i/k/Wikipedia%7E%E5%B8%AE%E5%8A%A9.html" title="Wikipedia:帮助">帮助</a>
<br /><form name="search" class="inline" method="post" action="../../../s/e/a/Special%7ESearch.html">
<input type="text" name="search" size="19" value="" />
<input type="submit" name="go" value="进入" />&nbsp;<input type="submit" name="fulltext" value="搜索" />
</form></td></tr>
</table>
</div>

<div id='article'>
<h1 class="pagetitle">Talk:ProxyProject</h1><p class='subtitle'>Wikipedia，自由的百科全书</p>
<table id='toc' class='toc'><tr><td><div id='toctitle'><h2>目录</h2></div>
<ul>
<li class='toclevel-1'><a href="#.E6.96.87.E6.A1.A3.E5.8C.BA"><span class="tocnumber">1</span> <span class="toctext">文档区</span></a></li>
<li class='toclevel-1'><a href="#.E5.BB.BA.E8.AE.AE"><span class="tocnumber">2</span> <span class="toctext">建议</span></a>
<ul>
<li class='toclevel-2'><a href="#.E5.B7.A5.E4.BD.9C.E5.8E.9F.E7.90.86.E8.AE.BE.E6.83.B3.EF.BC.9A"><span class="tocnumber">2.1</span> <span class="toctext">工作原理设想：</span></a></li>
<li class='toclevel-2'><a href="#.E4.B8.89.E7.A7.8D.E9.80.89.E6.8B.A9.E4.BB.A3.E7.90.86.E7.9A.84.E6.96.B9.E6.B3.95"><span class="tocnumber">2.2</span> <span class="toctext">三种选择代理的方法</span></a></li>
<li class='toclevel-2'><a href="#.E7.BC.96.E7.A8.8B.E4.B8.AD.E7.9A.84.E6.B3.A8.E6.84.8F.E4.BA.8B.E9.A1.B9"><span class="tocnumber">2.3</span> <span class="toctext">编程中的注意事项</span></a></li>
<li class='toclevel-2'><a href="#.E4.BB.A3.E7.90.86.E6.9C.8D.E5.8A.A1.E5.99.A8.E7.BA.BF.E7.A8.8B.EF.BC.9A"><span class="tocnumber">2.4</span> <span class="toctext">代理服务器线程：</span></a></li>
<li class='toclevel-2'><a href="#.E4.BB.A3.E7.90.86.E6.9C.8D.E5.8A.A1.E5.99.A8.E5.8F.AF.E7.94.A8.E5.88.97.E8.A1.A8.E6.96.87.E4.BB.B6.E6.A0.BC.E5.BC.8F"><span class="tocnumber">2.5</span> <span class="toctext">代理服务器可用列表文件格式</span></a></li>
<li class='toclevel-2'><a href="#.E7.BC.93.E5.AD.98.E6.9C.BA.E5.88.B6"><span class="tocnumber">2.6</span> <span class="toctext">缓存机制</span></a></li>
<li class='toclevel-2'><a href="#.E5.8F.98.E9.87.8F.E7.9A.84.E5.91.BD.E5.90.8D"><span class="tocnumber">2.7</span> <span class="toctext">变量的命名</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="#.E6.9E.84.E6.80.9D"><span class="tocnumber">3</span> <span class="toctext">构思</span></a>
<ul>
<li class='toclevel-2'><a href="#.E9.A1.B9.E7.9B.AE.E5.91.BD.E5.90.8D"><span class="tocnumber">3.1</span> <span class="toctext">项目命名</span></a></li>
<li class='toclevel-2'><a href="#VOTE.EF.BC.9AFlying_Bear"><span class="tocnumber">3.2</span> <span class="toctext">VOTE：Flying Bear</span></a></li>
</ul>
</li>
<li class='toclevel-1'><a href="#FAQ"><span class="tocnumber">4</span> <span class="toctext">FAQ</span></a>
<ul>
<li class='toclevel-2'><a href="#CVS_HOW-TO"><span class="tocnumber">4.1</span> <span class="toctext">CVS HOW-TO</span></a>
<ul>
<li class='toclevel-3'><a href="#.E7.99.BB.E9.99.86.EF.BC.9A"><span class="tocnumber">4.1.1</span> <span class="toctext">登陆：</span></a></li>
<li class='toclevel-3'><a href="#.E4.B8.8B.E8.BD.BD.E6.9C.80.E6.96.B0.E7.9A.84.E7.89.88.E6.9C.AC.E3.80.82"><span class="tocnumber">4.1.2</span> <span class="toctext">下载最新的版本。</span></a></li>
<li class='toclevel-3'><a href="#.E6.B7.BB.E5.8A.A0.EF.BC.9A"><span class="tocnumber">4.1.3</span> <span class="toctext">添加：</span></a></li>
<li class='toclevel-3'><a href="#.E6.8F.90.E4.BA.A4.EF.BC.9A"><span class="tocnumber">4.1.4</span> <span class="toctext">提交：</span></a></li>
<li class='toclevel-3'><a href="#.E6.B7.BB.E5.8A.A0.E6.96.87.E4.BB.B6.E5.88.B0CVS.E6.A8.A1.E5.9D.97.E4.B8.AD"><span class="tocnumber">4.1.5</span> <span class="toctext">添加文件到CVS模块中</span></a></li>
<li class='toclevel-3'><a href="#.E4.BB.8ECVS.E6.A8.A1.E5.9D.97.E4.B8.AD.E5.88.A0.E9.99.A4.E6.96.87.E4.BB.B6"><span class="tocnumber">4.1.6</span> <span class="toctext">从CVS模块中删除文件</span></a></li>
</ul>
</li>
</ul>
</li>
<li class='toclevel-1'><a href="#.E7.B3.BB.E7.BB.9F.E8.AF.84.E4.BB.B7.E6.96.B9.E6.A1.88"><span class="tocnumber">5</span> <span class="toctext">系统评价方案</span></a>
<ul>
<li class='toclevel-2'><a href="#.E5.AE.A2.E6.88.B7.E7.AB.AF.E7.A8.8B.E5.BA.8F.E8.BF.9E.E6.8E.A5.E7.9A.84.E9.80.9F.E5.BA.A6"><span class="tocnumber">5.1</span> <span class="toctext">客户端程序连接的速度</span></a>
<ul>
<li class='toclevel-3'><a href="#.E8.BF.9E.E7.BB.AD.E4.B8.8B.E8.BD.BD.E8.8B.A5.E5.B9.B2.E9.A1.B5.E9.9D.A2.E6.89.80.E9.9C.80.E7.9A.84.E6.97.B6.E9.97.B4"><span class="tocnumber">5.1.1</span> <span class="toctext">连续下载若干页面所需的时间</span></a></li>
<li class='toclevel-3'><a href="#.E4.BC.A0.E8.BE.93.E4.B8.80.E4.B8.AA.E8.BE.83.E5.A4.A7.E6.96.87.E4.BB.B6.E6.89.80.E9.9C.80.E7.9A.84.E6.97.B6.E9.97.B4"><span class="tocnumber">5.1.2</span> <span class="toctext">传输一个较大文件所需的时间</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#.E7.B3.BB.E7.BB.9F.E5.B9.B6.E5.8F.91.E8.83.BD.E5.8A.9B.5B.E5.B9.B3.E5.9D.87.E3.80.81.E6.9C.80.E5.A4.A7.E8.B4.9F.E8.8D.B7.E4.B8.8B.E4.B8.A4.E7.A7.8D.E6.83.85.E5.86.B5.5D"><span class="tocnumber">5.2</span> <span class="toctext">系统并发能力[平均、最大负荷下两种情况]</span></a>
<ul>
<li class='toclevel-3'><a href="#.E6.8E.A5.E6.94.B6.E7.9A.84.E5.AE.A2.E6.88.B7.E8.BF.9E.E6.8E.A5.E7.9A.84.E8.83.BD.E5.8A.9B"><span class="tocnumber">5.2.1</span> <span class="toctext">接收的客户连接的能力</span></a></li>
<li class='toclevel-3'><a href="#.E5.86.85.E5.AD.98.E5.92.8C.E5.A4.84.E7.90.86.E5.99.A8.E7.9A.84.E5.88.A9.E7.94.A8.E7.8E.87"><span class="tocnumber">5.2.2</span> <span class="toctext">内存和处理器的利用率</span></a></li>
<li class='toclevel-3'><a href="#.E5.8D.A0.E6.9C.89.E5.B8.A6.E5.AE.BD.E8.83.BD.E5.8A.9B"><span class="tocnumber">5.2.3</span> <span class="toctext">占有带宽能力</span></a></li>
<li class='toclevel-3'><a href="#.E6.94.B6.E5.8C.85.E9.80.9F.E5.BA.A6"><span class="tocnumber">5.2.4</span> <span class="toctext">收包速度</span></a></li>
<li class='toclevel-3'><a href="#.E6.94.B6.E5.8C.85.E6.B5.81.E9.87.8F"><span class="tocnumber">5.2.5</span> <span class="toctext">收包流量</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#.E9.80.89.E6.8B.A9.E4.BA.8C.E7.BA.A7.E4.BB.A3.E7.90.86.E8.83.BD.E5.8A.9B"><span class="tocnumber">5.3</span> <span class="toctext">选择二级代理能力</span></a>
<ul>
<li class='toclevel-3'><a href="#.E6.94.AF.E6.8C.81.E7.9A.84.E4.BA.8C.E7.BA.A7.E4.BB.A3.E7.90.86.E5.8D.8F.E8.AE.AE.E7.A7.8D.E7.B1.BB"><span class="tocnumber">5.3.1</span> <span class="toctext">支持的二级代理协议种类</span></a></li>
<li class='toclevel-3'><a href="#.E6.94.AF.E6.8C.81.E5.8A.A8.E6.80.81.E9.80.89.E6.8B.A9.E4.BA.8C.E7.BA.A7.E4.BB.A3.E7.90.86.E8.83.BD.E5.8A.9B"><span class="tocnumber">5.3.2</span> <span class="toctext">支持动态选择二级代理能力</span></a></li>
</ul>
</li>
</ul>
</li>
<li class='toclevel-1'><a href="#.E5.87.BD.E6.95.B0.E7.B4.A2.E5.BC.95"><span class="tocnumber">6</span> <span class="toctext">函数索引</span></a>
<ul>
<li class='toclevel-2'><a href="#algo_sort.h"><span class="tocnumber">6.1</span> <span class="toctext">algo_sort.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include"><span class="tocnumber">6.1.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0"><span class="tocnumber">6.1.2</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#tansmsg.h"><span class="tocnumber">6.2</span> <span class="toctext">tansmsg.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include_2"><span class="tocnumber">6.2.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_2"><span class="tocnumber">6.2.2</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#SocksTread.h"><span class="tocnumber">6.3</span> <span class="toctext">SocksTread.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include_3"><span class="tocnumber">6.3.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#.E7.BB.93.E6.9E.84.E4.BD.93"><span class="tocnumber">6.3.2</span> <span class="toctext">结构体</span></a></li>
<li class='toclevel-3'><a href="#.E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F"><span class="tocnumber">6.3.3</span> <span class="toctext">全局变量</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_3"><span class="tocnumber">6.3.4</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#SockServ.h"><span class="tocnumber">6.4</span> <span class="toctext">SockServ.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include_4"><span class="tocnumber">6.4.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#.E7.BB.93.E6.9E.84.E4.BD.93_2"><span class="tocnumber">6.4.2</span> <span class="toctext">结构体</span></a></li>
<li class='toclevel-3'><a href="#.E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F_2"><span class="tocnumber">6.4.3</span> <span class="toctext">全局变量</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_4"><span class="tocnumber">6.4.4</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#SockProxy.h"><span class="tocnumber">6.5</span> <span class="toctext">SockProxy.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include_5"><span class="tocnumber">6.5.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_5"><span class="tocnumber">6.5.2</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#tcp_listen.h"><span class="tocnumber">6.6</span> <span class="toctext">tcp_listen.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include_6"><span class="tocnumber">6.6.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_6"><span class="tocnumber">6.6.2</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#auth.h"><span class="tocnumber">6.7</span> <span class="toctext">auth.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include_7"><span class="tocnumber">6.7.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#Define"><span class="tocnumber">6.7.2</span> <span class="toctext">Define</span></a></li>
<li class='toclevel-3'><a href="#.E7.BB.93.E6.9E.84.E4.BD.93_3"><span class="tocnumber">6.7.3</span> <span class="toctext">结构体</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_7"><span class="tocnumber">6.7.4</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#cache.h"><span class="tocnumber">6.8</span> <span class="toctext">cache.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include_8"><span class="tocnumber">6.8.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#.E7.BB.93.E6.9E.84.E4.BD.93_4"><span class="tocnumber">6.8.2</span> <span class="toctext">结构体</span></a></li>
<li class='toclevel-3'><a href="#.E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F_3"><span class="tocnumber">6.8.3</span> <span class="toctext">全局变量</span></a></li>
<li class='toclevel-3'><a href="#Define_2"><span class="tocnumber">6.8.4</span> <span class="toctext">Define</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_8"><span class="tocnumber">6.8.5</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#checkip.h"><span class="tocnumber">6.9</span> <span class="toctext">checkip.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include_9"><span class="tocnumber">6.9.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#Define_3"><span class="tocnumber">6.9.2</span> <span class="toctext">Define</span></a></li>
<li class='toclevel-3'><a href="#.E7.BB.93.E6.9E.84.E4.BD.93_5"><span class="tocnumber">6.9.3</span> <span class="toctext">结构体</span></a></li>
<li class='toclevel-3'><a href="#.E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F_4"><span class="tocnumber">6.9.4</span> <span class="toctext">全局变量</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_9"><span class="tocnumber">6.9.5</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#child.h"><span class="tocnumber">6.10</span> <span class="toctext">child.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include_10"><span class="tocnumber">6.10.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#.E7.BB.93.E6.9E.84.E4.BD.93_6"><span class="tocnumber">6.10.2</span> <span class="toctext">结构体</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_10"><span class="tocnumber">6.10.3</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#ConStruct.h"><span class="tocnumber">6.11</span> <span class="toctext">ConStruct.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include_11"><span class="tocnumber">6.11.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#.E7.BB.93.E6.9E.84.E4.BD.93_7"><span class="tocnumber">6.11.2</span> <span class="toctext">结构体</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#ChildProcess.h"><span class="tocnumber">6.12</span> <span class="toctext">ChildProcess.h</span></a>
<ul>
<li class='toclevel-3'><a href="#include_12"><span class="tocnumber">6.12.1</span> <span class="toctext">include</span></a></li>
<li class='toclevel-3'><a href="#.E7.BB.93.E6.9E.84.E4.BD.93_8"><span class="tocnumber">6.12.2</span> <span class="toctext">结构体</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#ConStruct.h_2"><span class="tocnumber">6.13</span> <span class="toctext">ConStruct.h</span></a>
<ul>
<li class='toclevel-3'><a href="#Define_4"><span class="tocnumber">6.13.1</span> <span class="toctext">Define</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#queque.h"><span class="tocnumber">6.14</span> <span class="toctext">queque.h</span></a>
<ul>
<li class='toclevel-3'><a href="#Include"><span class="tocnumber">6.14.1</span> <span class="toctext">Include</span></a></li>
<li class='toclevel-3'><a href="#.E7.BB.93.E6.9E.84.E4.BD.93_9"><span class="tocnumber">6.14.2</span> <span class="toctext">结构体</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_11"><span class="tocnumber">6.14.3</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#RecvSend.h"><span class="tocnumber">6.15</span> <span class="toctext">RecvSend.h</span></a>
<ul>
<li class='toclevel-3'><a href="#Include_2"><span class="tocnumber">6.15.1</span> <span class="toctext">Include</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_12"><span class="tocnumber">6.15.2</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#RecvSend.h_2"><span class="tocnumber">6.16</span> <span class="toctext">RecvSend.h</span></a>
<ul>
<li class='toclevel-3'><a href="#Include_3"><span class="tocnumber">6.16.1</span> <span class="toctext">Include</span></a></li>
<li class='toclevel-3'><a href="#Define_5"><span class="tocnumber">6.16.2</span> <span class="toctext">Define</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_13"><span class="tocnumber">6.16.3</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#serv_info_def.h"><span class="tocnumber">6.17</span> <span class="toctext">serv_info_def.h</span></a>
<ul>
<li class='toclevel-3'><a href="#Define_6"><span class="tocnumber">6.17.1</span> <span class="toctext">Define</span></a></li>
<li class='toclevel-3'><a href="#.E7.BB.93.E6.9E.84.E4.BD.93_10"><span class="tocnumber">6.17.2</span> <span class="toctext">结构体</span></a></li>
<li class='toclevel-3'><a href="#.E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F_5"><span class="tocnumber">6.17.3</span> <span class="toctext">全局变量</span></a></li>
<li class='toclevel-3'><a href="#.E5.87.BD.E6.95.B0_14"><span class="tocnumber">6.17.4</span> <span class="toctext">函数</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#sock_type_def.h"><span class="tocnumber">6.18</span> <span class="toctext">sock_type_def.h</span></a>
<ul>
<li class='toclevel-3'><a href="#Define_7"><span class="tocnumber">6.18.1</span> <span class="toctext">Define</span></a></li>
<li class='toclevel-3'><a href="#.E7.BB.93.E6.9E.84.E4.BD.93_11"><span class="tocnumber">6.18.2</span> <span class="toctext">结构体</span></a></li>
</ul>
</li>
<li class='toclevel-2'><a href="#header.h"><span class="tocnumber">6.19</span> <span class="toctext">header.h</span></a>
<ul>
<li class='toclevel-3'><a href="#Include_4"><span class="tocnumber">6.19.1</span> <span class="toctext">Include</span></a></li>
<li class='toclevel-3'><a href="#Define_8"><span class="tocnumber">6.19.2</span> <span class="toctext">Define</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</td></tr></table>
<p><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "显示"; var tocHideText = "隐藏"; showTocToggle(); } </script>
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E6.96.87.E6.A1.A3.E5.8C.BA"></a><h1>文档区</h1>
<ol><li><a href="http://wiki.cs.hit.edu.cn/index.php/ProxyProject" class='external text' title="http://wiki.cs.hit.edu.cn/index.php/ProxyProject" rel="nofollow">主页</a>
</li><li><a href="http://wiki.cs.hit.edu.cn/index.php/Talk:ProxyProject" class='external text' title="http://wiki.cs.hit.edu.cn/index.php/Talk:ProxyProject" rel="nofollow">主页讨论区</a>
</li><li><a href="http://wiki.cs.hit.edu.cn/index.php/ProxyGroupDevDocs" class='external text' title="http://wiki.cs.hit.edu.cn/index.php/ProxyGroupDevDocs" rel="nofollow">开发人员文档</a>
</li><li><a href="http://wiki.cs.hit.edu.cn/index.php/ProxyGroupAdminDocs" class='external text' title="http://wiki.cs.hit.edu.cn/index.php/ProxyGroupAdminDocs" rel="nofollow">管理员文档</a>
</li><li><a href="http://wiki.cs.hit.edu.cn/index.php/ProxyGroupUserDocs" class='external text' title="http://wiki.cs.hit.edu.cn/index.php/ProxyGroupUserDocs" rel="nofollow">用户文档</a>
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.BB.BA.E8.AE.AE"></a><h1>建议</h1>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.B7.A5.E4.BD.9C.E5.8E.9F.E7.90.86.E8.AE.BE.E6.83.B3.EF.BC.9A"></a><h2>工作原理设想：</h2>
<p>最重要的是：<b>我们做得Socks代理只是一个部分，更准确的说是一个插件。</b>所以在具体的功能函数中不要显式的直接出现以Socks函数。以发送数据包为例，正确的应该是先有一个send函数，在这个函数中，通过读配置文件获取现在支持的类型，然后调用socksSend函数。
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E4.B8.89.E7.A7.8D.E9.80.89.E6.8B.A9.E4.BB.A3.E7.90.86.E7.9A.84.E6.96.B9.E6.B3.95"></a><h2>三种选择代理的方法</h2>
<p>A <b>手动选择代理：</b>代理列表由系统管理员选择优选权
</p><p>B <b>自动选择代理:</b>   代理列表由系统自动探测，并决定优选权
</p><p>C <b>综合选择代理:</b>   代理列表由系统自动探测，并决定优选权，同时管理员在此基础上可以设置规则
</p><p>在自动选择代理和综合选择代理中，系统应支持下列优选权决策方案：
</p><p>1 有权值循环选择代理 ：每个代理都有一个权值，网络速度快的代理权值高。例如，代理A速度为200K/s，代理B为100K/s，则A的权值为20，B的权值为10。有权值循环选择则是连结A20次，之后连结B 10次，以此类推。(经过讨论,我们发现对于不同的页面,连接成功的速度可能一样,但抓页面的时间却可能不一样,因此,采用速度来计算比较合理,公平---lxx)
<a href="http://wiki.cs.hit.edu.cn/index.php/algo-1" class='external text' title="http://wiki.cs.hit.edu.cn/index.php/algo-1" rel="nofollow">实现方案</a>
</p><p>2 有权值随机选择代理：权值原理部分与有权值循环选择代理一致，但是在具体选择用哪个代理时是采用了随机数的方法。权值高的易于被选中。
<a href="http://wiki.cs.hit.edu.cn/index.php/algo-2" class='external text' title="http://wiki.cs.hit.edu.cn/index.php/algo-2" rel="nofollow">实现方案</a>］
</p><p>3 无权值循环选择代理： 每个代理的权值都是常数（为了兼容有权值方法而存在的），例如，所有代理权值都为1，则工作时，先连接A1次，之后连接B 1次，以此类推。
<a href="http://wiki.cs.hit.edu.cn/index.php/algo-3" class='external text' title="http://wiki.cs.hit.edu.cn/index.php/algo-3" rel="nofollow">实现方案</a>
</p><p>4 无权值随机选择代理： 每个代理的权值都是常数（为了兼容有权值方法而存在的），在选择代理的时候，每个代理被选中的概率是相等的。
</p><p>在每次测得一个代理服务器的速度之后，应该结合上一次的速度，来决定这次的速度。这一点，可以参考TCP协议实现中的RTT值的决定。<br />
假设主机A原来的传输时间为oldtime，现在测得的时间差为newtime，则综合得到的时间应该是：
</p>
<pre>   Time[i] = Time[i-1] * α+ newtime * (1-α)
</pre>
<p>其中，α是一个0到1之间的比例系数，可以根据具体的情况设定。当要求对网络变化敏感时，α可以设小一点，否则可以设大一点。<br />
Time有一个上限值，表示网络不可达。记为 Limit<br />
当某次连接失败，newtime=Limit，则Time[i] = Time[i-1] * α+ Limit * (1-α)，当α比较小时，很快地Time就趋近于Limit，表示在这段时间中主机不可达。<br />
这里判断条件可以是 Time &gt; Limit * β (其中β等于一个比较接近1的值) 表示Time大于极限值之后，认为Time 等于无穷大。则令 Time =Limit <br />
当某主机的Time等于无穷大之后，测试该主机的时间差加倍，当重试若干次之后，如果还是无穷大时，则将其从可用列表中删除。
<a href="http://wiki.cs.hit.edu.cn/index.php/algo-4" class='external text' title="http://wiki.cs.hit.edu.cn/index.php/algo-4" rel="nofollow">实现方案</a>
</p>
<pre>   以上想法有一个问题就是：始终连接的是向一台远端主机发送Get请求，所以无法对所有的网络情况有一个最优的决策。例如，如果我发送的请求总是到news.sohu.com的话，那么我只知道到news.sohu.com的路径中，代理A是最快的，但是我不知道到news.sohu.com的路径中，也许代理B是最快的。
</pre>
<p>--<a href="../../../l/i/u/User%7ELiuwenmao.html" class="new" title="User:Liuwenmao">Liuwenmao</a> 16:58 2005年9月12日 (CST)
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BC.96.E7.A8.8B.E4.B8.AD.E7.9A.84.E6.B3.A8.E6.84.8F.E4.BA.8B.E9.A1.B9"></a><h2>编程中的注意事项</h2>
<p>还有希望大家把一些常数，或是配置文件的选项放到fbear.conf和.h文件中。<br />
此外，请大家将自己的.h文件妥善管理，不要随便修改别人的.h文件，也不要将自己用到的变量全部写到一个“functions.h”文件中，这样可读性太差了，也不利于调试。<br />
--<a href="../../../l/i/u/User%7ELiuwenmao.html" class="new" title="User:Liuwenmao">Liuwenmao</a> 16:24 2005年9月12日 (CST)
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E4.BB.A3.E7.90.86.E6.9C.8D.E5.8A.A1.E5.99.A8.E7.BA.BF.E7.A8.8B.EF.BC.9A"></a><h2>代理服务器线程：</h2>
<p>对于每两个"客户端-&gt;代理-&gt;服务器， 服务器-&gt;代理-〉客户端"的连接，我们都建立一个数据结构（图中的Basic Connection Entity），其中包含四个线程：与客户端连接的接收、发送线程，以及与服务器端连接的接收、发送线程。
<a href="../../../t/h/r/Image%7EThread.JPG_6fbe.html" class="image" title="Image:Thread.JPG"><img src="../../../../upload/f/ff/Thread.JPG" alt="Image:Thread.JPG" width="750" height="379" longdesc="../../../t/h/r/Image%7EThread.JPG_6fbe.html" /></a><br />
<b>结构</b>：其中，作为一个连接，例如 Client Receiving Thread 和 Server Sending Thread共享一个缓冲区队列，当Client Receiving Thread接收到客户端的数据，并将一个缓冲区填满之后，将在这个队列中添加一项，并通知Server Sending Thread，当Server Sending Thread接收到一个信号时，将检查自己的缓冲区列表。如果不空，则取出第一项，发送给服务器端。完成后继续等待信号，同时阻塞自己。<br />
这样，每一个线程都能独立的工作，又能与其他的线程通信。<br />
为了阐述简单，我们将Client Receiving Thread设为Thread 1，Server Sending Thread设为Thread 2， Server Receiving Thread设为Thread 3，Client Sending Thread 设为Thread 4。如上图。<br />
<b>数据通信</b>：Thread 1和 Thread 3 在接收数据时把自己阻塞起来。<br />
假定Thread 1 接收到数据后，Thread 1，会首先将缓冲区队列加锁，将数据存放至某一个可用的缓冲区，然后解锁，通知Thread 2。<br />
Thread 2对缓冲区队列加锁后检查队列，发送非空的缓冲区，最后解锁。<br />
对于Thread 3和Thread 4的情况类似<br />
<b>关闭连接</b>：假定服务器对代理服务器发送FIN报文，这时候Thread 2将收到长度为0的数据。此时，Thread 2将设置“与服务器连接已断”的条件ServerConnectionClosed，同时唤醒并通知Thread 2和Thread 4。<br />
Thread 2 获悉ServerConnectionClosed之后，线程正常退出。<br />
Thread 3 获悉ServerConnectionClosed之后，将数据缓冲区队列的数据全部发送完毕之后，将Thread 1 Kill，之后正常退出。<br />
四个线程的宿主进程在 Thread 2、3，4都Join之后，说明一次连接已经成功结束。通知父进程。<br />
</p><p><a href="../../../b/a/s/Image%7EBasic_Connection_Entity.JPG_585f.html" class="image" title="Image:Basic_Connection_Entity.JPG"><img src="../../../../upload/6/6b/Basic_Connection_Entity.JPG" alt="Image:Basic_Connection_Entity.JPG" width="693" height="387" longdesc="../../../b/a/s/Image%7EBasic_Connection_Entity.JPG_585f.html" /></a><br />
上图是一个连接的基本数据结构图<br />
一个连接结构存放四个线程的结构体。每个结构体都有该线程的线程号、以及该线程拥有缓冲区的队列。队列中每个数据项都是指向缓冲区组的某一个缓冲区。
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E4.BB.A3.E7.90.86.E6.9C.8D.E5.8A.A1.E5.99.A8.E5.8F.AF.E7.94.A8.E5.88.97.E8.A1.A8.E6.96.87.E4.BB.B6.E6.A0.BC.E5.BC.8F"></a><h2>代理服务器可用列表文件格式</h2>
<p>我建议格式如下：(方括号表示可选)<br />
协议类型://主机地址:端口[@用户名/密码]<br />
例如:<br />
socks5://202.118.250.18:1080@ibmtc/ibmtest <br />
socks4://202.118.250.18:1080@ibmtc/ibmtest <br />
http://202.118.250.18:8080@ibmtc/ibmtest<br />
--<a href="../../../l/i/u/User%7ELiuwenmao.html" class="new" title="User:Liuwenmao">Liuwenmao</a> 16:24 2005年9月12日 (CST)
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BC.93.E5.AD.98.E6.9C.BA.E5.88.B6"></a><h2>缓存机制</h2>
<p>由于代理服务器提高性能的关系，需要将一些常用的页面存在本地，这就是代理服务器的缓存机制。
我们将需要存放的文件存放在cache文件夹中，这个文件夹可以在fbear.conf配置文件中定义。
我们采用的存放结构为：
</p>
<pre>-根目录cache
 --子目录 www.cs.hit.edu.cn_8080
   ---index.html
   ---logo.jpg
   ---...
--子目录 202.118.250.18
--子目录 www.baidu.com
   ---index.php
   ---...
</pre>
<p>其中子目录为站点名，格式为：主机［_端口］，如果 _端口 没有，则默认为80端口。
该目录下存放本站点的文件
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.8F.98.E9.87.8F.E7.9A.84.E5.91.BD.E5.90.8D"></a><h2>变量的命名</h2>
<p>大家有什么好的想法，可以提出来
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E6.9E.84.E6.80.9D"></a><h1>构思</h1>
<p>只要是想法,都可以在这里以条目的形式写出来
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E9.A1.B9.E7.9B.AE.E5.91.BD.E5.90.8D"></a><h2>项目命名</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="VOTE.EF.BC.9AFlying_Bear"></a><h2>VOTE：Flying Bear</h2>
<pre>PROBLEM&nbsp;: PROxy BaLance SystEM&nbsp;:-)
Procher&nbsp;: Proxy Switcher 我也不知道什么意思，简单吧，呵呵
                                             by Liuwenmao
</pre>
<pre>我想了好久，想到一下命名，文懋说的对，最重要的是简单易读，而且让人印象深刻：
我想到的有noppy[Network resOurce oPtimizing Proxy sYstem]，中文叫诺派<br />
还有：以行星取名：我选海王星：Neptune，这个只是感觉；<br />
还有Lagexy[Linux agenxy],这个也是我觉得不错的，只是感觉。中文名叫：……不好叫，不是很好听，大家在想想吧，要不就叫动物名了。<br />
还有命名网站：<a href="http://www.china-naming.com/bbs/forum/forumdisplay.php?s=0f226bce94ee30e30dc57e6c57a70032&amp;forumid=90" class='external text' title="http://www.china-naming.com/bbs/forum/forumdisplay.php?s=0f226bce94ee30e30dc57e6c57a70032&amp;forumid=90" rel="nofollow">点击这里</a>
                                               by Linxiangxin
 
&lt;&lt;----我觉得不如叫NOPS（Network Optimizing Proxy System）,nop是Intel的汇编指令，令人印象深刻&nbsp;:)
                                                by Liuwenmao
</pre>
<pre>  我支持nops，原来也想过！                         by Linxiaoxin
</pre>
<pre> Proxyworm：类似于bookworm那种感觉。找一个百战天虫那个卡通形象，一定很Q。还有那种爬虫的含义。                                                   --<a href="../../../2/0/2/User%7E202.118.236.174.html" class="new" title="User:202.118.236.174">202.118.236.174</a> 14:06 2005年9月20日 (CST)
</pre>
<p><br />
备选项:
</p>
<pre>1 PROBLEM [SPer：]
2 Procher [SPer：]
3 Neptune [SPer：]
4 Lagexy [SPer：]
5 NOPPY [SPer：林晓鑫]
6 Proxyworm [SPer：刘文懋 罗阳春 熊飞]
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="FAQ"></a><h1>FAQ</h1>
<p>疑难杂症
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="CVS_HOW-TO"></a><h2>CVS HOW-TO</h2>
<p>更多见 <a href="http://wiki.cs.hit.edu.cn/index.php/Cvs" class='external text' title="http://wiki.cs.hit.edu.cn/index.php/Cvs" rel="nofollow">CVS无废话</a>
</p><p>昨天刚配完，急了一点，所以没有具体说怎么用CVS。
现在简单的说一下：
</p><p>现在我给每个人都建了一个账号，密码是每个人的邮箱密码。例如，刘德超的帐号是liudechao。
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.99.BB.E9.99.86.EF.BC.9A"></a><h3>登陆：</h3>
<p>导出环境变量：export CVSROOT=:pserver:fbear@202.118.250.19:/cvsroot
登陆：cvs login。
这时系统会提示输入密码，输入fb密码即可。
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E4.B8.8B.E8.BD.BD.E6.9C.80.E6.96.B0.E7.9A.84.E7.89.88.E6.9C.AC.E3.80.82"></a><h3>下载最新的版本。</h3>
<p>我们的module是flyingbear。所以先到一个目录，假设为~/projects，
输入：cvs checkout flyingbear.
这样，你会发现当前目录中出现一个flyingbear目录，这个目录就是flyingbear的主目录，进入这个目录，进行修改。
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E6.B7.BB.E5.8A.A0.EF.BC.9A"></a><h3> 添加：</h3>
<p>执行cvs checkout xxx 后，先在本地建立一个目录mkdir dir_name，或则文件touch file_name，然后采用cvs add xxx(添加文件名）这样就在cvs中添加了一个文件，也可以是文件夹，然后将文件提交就行了
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E6.8F.90.E4.BA.A4.EF.BC.9A"></a><h3>提交：</h3>
<p>现在我们对README进行了修改，想把它提交，可以在当前目录输入：
cvs commit README, 这时会出现一个类似vi的环境，这时你需要输入修改的原因，以便以后检查。
</p><p><br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E6.B7.BB.E5.8A.A0.E6.96.87.E4.BB.B6.E5.88.B0CVS.E6.A8.A1.E5.9D.97.E4.B8.AD"></a><h3>添加文件到CVS模块中</h3>
<p>假设如上，我们现在增加了一个Makefile文件，需要将它添加到CVS中，那么我们需要两步：
1 cvs add README (注意路径)
2 cvs commit README
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E4.BB.8ECVS.E6.A8.A1.E5.9D.97.E4.B8.AD.E5.88.A0.E9.99.A4.E6.96.87.E4.BB.B6"></a><h3>从CVS模块中删除文件</h3>
<p>假设如上，我们现在删除一个Makefile文件，那么我们同样需要两步：
1 cvs remove README (注意路径)
2 cvs commit
</p><p><br />
</p>
<pre> 好习惯：每天工作之前都check一下
</pre>
<p>--<a href="../../../2/0/2/User%7E202.118.228.100.html" class="new" title="User:202.118.228.100">202.118.228.100</a> 11:06 2005年9月23日 (CST)
</p><p><br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.B3.BB.E7.BB.9F.E8.AF.84.E4.BB.B7.E6.96.B9.E6.A1.88"></a><h1>系统评价方案</h1>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.AE.A2.E6.88.B7.E7.AB.AF.E7.A8.8B.E5.BA.8F.E8.BF.9E.E6.8E.A5.E7.9A.84.E9.80.9F.E5.BA.A6"></a><h2>客户端程序连接的速度</h2>
<p>作为客户端的程序，在一段较长的时间中，对其平均通信速度进行评价。包括
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E8.BF.9E.E7.BB.AD.E4.B8.8B.E8.BD.BD.E8.8B.A5.E5.B9.B2.E9.A1.B5.E9.9D.A2.E6.89.80.E9.9C.80.E7.9A.84.E6.97.B6.E9.97.B4"></a><h3>连续下载若干页面所需的时间</h3>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E4.BC.A0.E8.BE.93.E4.B8.80.E4.B8.AA.E8.BE.83.E5.A4.A7.E6.96.87.E4.BB.B6.E6.89.80.E9.9C.80.E7.9A.84.E6.97.B6.E9.97.B4"></a><h3>传输一个较大文件所需的时间</h3>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.B3.BB.E7.BB.9F.E5.B9.B6.E5.8F.91.E8.83.BD.E5.8A.9B.5B.E5.B9.B3.E5.9D.87.E3.80.81.E6.9C.80.E5.A4.A7.E8.B4.9F.E8.8D.B7.E4.B8.8B.E4.B8.A4.E7.A7.8D.E6.83.85.E5.86.B5.5D"></a><h2>系统并发能力[平均、最大负荷下两种情况]</h2>
<p>在代理服务器系统角度来说，需要对其的并发能力进行评价。例如，
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E6.8E.A5.E6.94.B6.E7.9A.84.E5.AE.A2.E6.88.B7.E8.BF.9E.E6.8E.A5.E7.9A.84.E8.83.BD.E5.8A.9B"></a><h3>接收的客户连接的能力</h3>
<ol><li>能接收客户的连接数
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.86.85.E5.AD.98.E5.92.8C.E5.A4.84.E7.90.86.E5.99.A8.E7.9A.84.E5.88.A9.E7.94.A8.E7.8E.87"></a><h3>内存和处理器的利用率</h3>
<ol><li>内存的占用率
</li><li>处理器的占用率
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.8D.A0.E6.9C.89.E5.B8.A6.E5.AE.BD.E8.83.BD.E5.8A.9B"></a><h3>占有带宽能力</h3>
<ol><li>在工作条件下，网络带宽的占用量
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E6.94.B6.E5.8C.85.E9.80.9F.E5.BA.A6"></a><h3>收包速度</h3>
<p>单位pps(Packes Per Second)
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E6.94.B6.E5.8C.85.E6.B5.81.E9.87.8F"></a><h3>收包流量</h3>
<p>单位bps(Bits Per Second)
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E9.80.89.E6.8B.A9.E4.BA.8C.E7.BA.A7.E4.BB.A3.E7.90.86.E8.83.BD.E5.8A.9B"></a><h2>选择二级代理能力</h2>
<p>作为一个专注于对二级代理评价、测试和选择的系统，Flying Bear应该对二级代理的速度、负载能力。需要对这个能力进行评价。包括
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E6.94.AF.E6.8C.81.E7.9A.84.E4.BA.8C.E7.BA.A7.E4.BB.A3.E7.90.86.E5.8D.8F.E8.AE.AE.E7.A7.8D.E7.B1.BB"></a><h3>支持的二级代理协议种类</h3>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E6.94.AF.E6.8C.81.E5.8A.A8.E6.80.81.E9.80.89.E6.8B.A9.E4.BA.8C.E7.BA.A7.E4.BB.A3.E7.90.86.E8.83.BD.E5.8A.9B"></a><h3>支持动态选择二级代理能力</h3>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0.E7.B4.A2.E5.BC.95"></a><h1>函数索引</h1>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="algo_sort.h"></a><h2>algo_sort.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include"></a><h3>include</h3>
<p>"serv_check.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0"></a><h3>函数</h3>
<ol><li>void speed1_optimize()
</li><li>ptr_serv_info serv_randon_sel()
</li><li>ptr_serv_info serv_cycle()
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="tansmsg.h"></a><h2>tansmsg.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include_2"></a><h3>include</h3>
<p>"headers.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_2"></a><h3>函数</h3>
<ol><li>ssize_t write_fd(int fd, void *ptr, size_t nbytes, int sendfd)
</li><li>ssize_t read_fd(int fd, void *ptr, size_t nbytes, int *recvfd)
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="SocksTread.h"></a><h2>SocksTread.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include_3"></a><h3>include</h3>
<p>"headers.h"、"RecvSend.h"、"queue.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BB.93.E6.9E.84.E4.BD.93"></a><h3>结构体</h3>
<pre>struct Buffer
{
	int flag;
	char buf[BUFSIZE];
	int len;
};
struct WorkQueue
{
	pthread_t recvTid,sendTid;
	int cp,sp;
	pthread_mutex_t mutex;
	pthread_cond_t cond;
	struct Buffer buffer[BUFNUM];
	queue bufQue;
};
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F"></a><h3>全局变量</h3>
<pre>struct WorkQueue WqCliToServ, WqServToCli;
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_3"></a><h3>函数</h3>
<ol><li>void InitWq()
</li><li>void *RecvThread_FromCli(void* con)
</li><li>void *SendThread_ToServ(void* conn)
</li><li>void *RecvThread_FromServ(void* conn)
</li><li>void *SendThread_ToCli(void *conn)
</li><li>void InitUdpThread(UCI* udpConnec)
</li><li>void *UdpThread_CliToServ(void* con)
</li><li>void *UdpThread_ServToCli(void* con)
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="SockServ.h"></a><h2>SockServ.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include_4"></a><h3>include</h3>
<p>"headers.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BB.93.E6.9E.84.E4.BD.93_2"></a><h3>结构体</h3>
<pre>struct TcpConnectInfo {
	int dstfd;
	struct sockaddr_in dstaddr;
	int clifd;
	struct sockaddr_in cliaddr;
	socklen_t clilen;
};
struct UdpConnectInfo {
	int dstfd;
	struct sockaddr_in dstaddr;
	int clifd;
	struct sockaddr_in cliaddr;
	socklen_t clilen;
};
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F_2"></a><h3>全局变量</h3>
<pre>struct TcpConnectInfo connList [10];
struct UdpConnectInfo udpConnList[10];
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_4"></a><h3>函数</h3>
<pre>int RecvData(int i,unsigned char *data,int flag)
int SendData(int i, unsigned char* data, int len, int flag)
void SocksConnMthod(int i)
int ConnectDst(int i, in_addr_t dstIP, uint16_t dstPort) -----------------------1------------------
void TcpTransdata(int i)
void UdpTransdata(int i)
void SocksTcp(int i,unsigned char* recvMsg)
void SocksUdp(int i, unsigned char* recvMsg)
void SocksReplies(int i)
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="SockProxy.h"></a><h2>SockProxy.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include_5"></a><h3>include</h3>
<p>"SocksThread.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_5"></a><h3>函数</h3>
<pre>int ConnectDst(TCI* tcpConnec, in_addr_t dstIP, uint16_t dstPort)-----------------------1------------------

void TcpTransdata(TCI* tcpConnec)
void UdpTransdata(UCI* udpConnec)
void Socks5ConnResp(TCI *tcpConnec, unsigned char *recvMsg)
void Socks5Tcp(TCI* tcpConnec,unsigned char* recvMsg)
void SocksUdp(TCI* tcpConnec, unsigned char* recvMsg)
void Socks5CmdResp(TCI* tcpConnec)
void Sock4Conn(TCI *tcpConnec,unsigned char *recvMsg)
void SocksRecvCheck(TCI *tcpConnec)
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="tcp_listen.h"></a><h2>tcp_listen.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include_6"></a><h3>include</h3>
<p>"headers.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_6"></a><h3>函数</h3>
<pre>int tcp_listen(const char *host, const char *serv, socklen_t *addrlenp)
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="auth.h"></a><h2>auth.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include_7"></a><h3>include</h3>
<p>&lt;arpa/inet.h&gt;、 "global.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Define"></a><h3>Define</h3>
<pre>#define DEFAULT_AUTH_FILE "../conf/auth.conf"
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BB.93.E6.9E.84.E4.BD.93_3"></a><h3>结构体</h3>
<pre>struct auth_entity
{
	in_addr_t net;
	unsigned long mask;
	char *user;
	char *passwd;
	struct auth_entity* next;
};
extern struct auth_entity* auth_list;
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_7"></a><h3>函数</h3>
<ol><li>char* get_first_char(char* line);//Get the first non-blank and non-tab char
</li><li>char* get_first_blank(char* line);//Get the first blank or tab
</li><li>int load_auth_conf_file();
</li><li>void print_auth_entities(struct auth_entity *list);
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="cache.h"></a><h2>cache.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include_8"></a><h3>include</h3>
<p>&lt;arpa/inet.h&gt;、"global.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BB.93.E6.9E.84.E4.BD.93_4"></a><h3>结构体</h3>
<pre>struct cache_entity{
	char* host;
	short port;
	char* file;
	char* cachefile;
	time_t mtime;
	struct cache_entity* next;
};
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F_3"></a><h3>全局变量</h3>
<p>extern struct cache_entity* cache_list[MAX_CACHE_ENTITIES];
extern time_t EXPIRE_T;
extern char* CACHE_DIR;
extern char* requests_list[REQUESTS];
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Define_2"></a><h3>Define</h3>
<pre>#define DEFAULT_CACHE_DIR "../cache/"
#define MAX_CACHE_ENTITIES 200
#define HASH_CHARS 10
#define DEFAULT_EXPIRE_T 300
#define REQUESTS 10
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_8"></a><h3>函数</h3>
<ol><li>int load_cache_entities(char* path);
</li><li>void add_cache_entity(char* host,short port,char* file,time_t mtime);
</li><li>void print_cache_entities(struct cache_entity *list[]);
</li><li>int hash(char* a,char* b);
</li><li>int check_header(char* header,size_t len,int* alive_time);
</li><li>struct cache_entity*  find_cache_entity(char* host,char *file,short port,struct cache_entity* list[]);
</li><li>int get_cache_info(char* host,short port,char* file,char* basepath,int* m_time,char** ful_name);
</li><li>int write_cache_file(char* host,short port,char* file,char* basepath,char** ful_name,char* data,size_t len);
</li><li>char* get_cache_dir();
</li><li>char* get_option_value(char* option_name);
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="checkip.h"></a><h2>checkip.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include_9"></a><h3>include</h3>
<p>&lt;arpa/inet.h&gt;、 "global.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Define_3"></a><h3>Define</h3>
<pre>#define EDUNET 0 //edu.cn provider
#define TELECOM 1 //telcom provider
#define CNCNET 2 //cnc net provider
#define FORN	3 //forgein provider
#define ERRPRD 4 //wrong provider
#define ERRFMT 5 //wrong format
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BB.93.E6.9E.84.E4.BD.93_5"></a><h3>结构体</h3>
<pre>typedef int net_type;
struct net_entity
{
	in_addr_t net;
	unsigned long mask;
	struct net_entity* next;
};
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F_4"></a><h3>全局变量</h3>
<pre>extern struct net_entity* cnc_net_list;
extern struct net_entity* tele_net_list;
extern struct net_entity* edu_net_list;
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_9"></a><h3>函数</h3>
<ol><li>int get_nettype_conf_file(char** cncnet,char** telecom,char** edunet);
</li><li>int load_net_list(char* net_conf_file,struct net_entity** list);
</li><li>void print_net_entities(struct net_entity *list);
</li><li>int load_nettype_file();
</li><li>int is_provider(int ip_t,struct net_entity *list);
</li><li>net_type check_ip(char *ip);
</li><li>int same_net(in_addr_t ip_t,in_addr_t net,long mask);
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="child.h"></a><h2>child.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include_10"></a><h3>include</h3>
<p>"tansmsg.h" 、 "SocksProxy.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BB.93.E6.9E.84.E4.BD.93_6"></a><h3>结构体</h3>
<pre>typedef struct {
   pid_t   child_pid;         /* process ID */
   int     child_pipefd;      /* parent's stream pipe to/from child */
   int     child_status;      /* 0 = ready */
   long    child_count;       /* # connections handled */
} child;
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_10"></a><h3>函数</h3>
<ol><li>pid_t child_make(int i, int listenfd, int addrlen)
</li><li>void child_main(int i, int listenfd, int addrlen)
</li><li>void socks_child(TCI* TcpConnInfo)
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="ConStruct.h"></a><h2>ConStruct.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include_11"></a><h3>include</h3>
<p>"headers.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BB.93.E6.9E.84.E4.BD.93_7"></a><h3>结构体</h3>
<pre>typedef struct a{
	int dstfd;
	struct sockaddr_in dstaddr;
	int clifd;
	struct sockaddr_in cliaddr;
	socklen_t clilen;
}TCI;
typedef struct UdpConnectInfo {
   int dstfd;
   struct sockaddr_in dstaddr;
   int clifd;
   struct sockaddr_in cliaddr;
   socklen_t clilen;
   unsigned char udpHead[262];
   size_t headlen;
}UCI;
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="ChildProcess.h"></a><h2>ChildProcess.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="include_12"></a><h3>include</h3>
<p>"headers.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BB.93.E6.9E.84.E4.BD.93_8"></a><h3>结构体</h3>
<pre>typedef struct {
	pid_t   child_pid;         /* process ID */
	int     child_pipefd;      /* parent's stream pipe to/from child */
	int     child_status;      /* 0 = ready */
	long    child_used;        /* 1 = used */
} child;
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="ConStruct.h_2"></a><h2>ConStruct.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Define_4"></a><h3>Define</h3>
<pre>#define CONF_FILE "../conf/fbear.conf"
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="queque.h"></a><h2>queque.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Include"></a><h3>Include</h3>
<p>&lt;stdlib.h&gt;
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BB.93.E6.9E.84.E4.BD.93_9"></a><h3>结构体</h3>
<pre>typedef struct node {
	int bufindex;
	struct node *next;
} node;
typedef struct queue {
	node *head, *tail; 
} queue;
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_11"></a><h3>函数</h3>
<ol><li>void queue_put(queue *root,int bufindex)
</li><li>int queue_get(queue *root)
</li><li>void queue_init(queue *root)
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="RecvSend.h"></a><h2>RecvSend.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Include_2"></a><h3>Include</h3>
<p>"headers.h"、"ConStruct.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_12"></a><h3>函数</h3>
<ol><li>int RecvData(TCI* connec,unsigned char *data,int flag)
</li><li>int SendData(TCI* connec, unsigned char* data, int len, int flag)
</li></ol>
<p><br />
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="RecvSend.h_2"></a><h2>RecvSend.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Include_3"></a><h3>Include</h3>
<p>&lt;netinet/in.h&gt;、&lt;stdio.h&gt;、&lt;sys/socket.h&gt;、&lt;sys/types.h&gt;、&lt;stdlib.h&gt;、&lt;string.h&gt;、&lt;netdb.h&gt;、&lt;errno.h&gt;、&lt;stdlib.h&gt;、&lt;time.h&gt;、"sock_type_def.h"、"serv_info_def.h"
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Define_5"></a><h3>Define</h3>
<pre>#define SERV_FILENAME "doc/serlist.txt"
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_13"></a><h3>函数</h3>
<ol><li>void initial_serv_list()
</li><li>int connect_proxy(ptr_serv_info head,int *sum_bytes_ptr)
</li><li>int connect_remote_site(int sockfd,int *sum_bytes_ptr)
</li><li>struct timeval *tvsub(struct timeval *end,struct timeval *begin)
</li><li>void time_optimize()
</li><li>void speed_optimize()
</li><li>void proxy_speed_test()
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="serv_info_def.h"></a><h2>serv_info_def.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Define_6"></a><h3>Define</h3>
<pre>#define MAXSERVER 100
#define STEP 10 
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BB.93.E6.9E.84.E4.BD.93_10"></a><h3>结构体</h3>
<pre>struct serv_struct
{
      unsigned long  ipaddr;
      unsigned short port;
      float          newtime;
      float          time;
      float 			newspeed;
      float 			speed;
      char  protocol  [10];
      char    id      [16];
      char   pwd      [16];
};
typedef struct serv_struct * ptr_serv_info;
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.85.A8.E5.B1.80.E5.8F.98.E9.87.8F_5"></a><h3>全局变量</h3> 
<ol><li>ptr_serv_info serv_list[MAXSERVER]={NULL};
</li><li>int serv_list_length=0;
</li><li>int rand_sel_list[MAXSERVER]={0};
</li><li>float rand_sel_max;
</li><li>int serv_cycle_offset=0;
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E5.87.BD.E6.95.B0_14"></a><h3>函数</h3>
<ol><li>void rand_sel_list_init()
</li><li>void sort_serv_list_by_time()
</li><li>void sort_serv_list_by_speed()
</li><li>void add_serv_node(ptr_serv_info ps)
</li></ol>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="sock_type_def.h"></a><h2>sock_type_def.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Define_7"></a><h3>Define</h3>
<pre>#define SPEED_LIMIT 0
#define TIME_LIMIT 1000
#define REMOTE_PORT 80
#define REMOTE_SRV "202.108.250.218"
#define BUF_SIZE 1024
#define TIME_OPT_PRO 0.8
#define TIME_TOP_PRO 0.9
#define SPEED_OPT_PRO 0.8
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name=".E7.BB.93.E6.9E.84.E4.BD.93_11"></a><h3>结构体</h3>
<pre>struct con_req
{
	char ver;
	char nmethods;
	char methods[6];
};
struct con_ans
{
	char ver;
	char method;
};
struct sock5_req
{
	char ver;
	char cmd;
	char rsv;
	char atyp;
	unsigned int dest_addr;
	unsigned short dest_port;
}__attribute__((packed));
struct sock5_ans
{
	char ver;
	char rep;
	char rsv;
	char atyp;
	unsigned int bnd_addr;
	unsigned short bnd_port;
};
</pre>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="header.h"></a><h2>header.h</h2>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Include_4"></a><h3>Include</h3>
<p>&lt;sys/types.h&gt;、&lt;sys/socket.h&gt;、&lt;netinet/in.h&gt;、&lt;arpa/inet.h&gt;、&lt;strings.h&gt;、 &lt;unistd.h&gt;、&lt;errno.h&gt;、&lt;stdio.h&gt;、&lt;stdlib.h&gt;、&lt;string.h&gt;、&lt;pthread.h&gt;、&lt;stdlib.h&gt;、&lt;unistd.h&gt;、&lt;netdb.h&gt;
</p>
<div class="editsection" style="float:right;margin-left:5px;">[<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑</a>]</div><a name="Define_8"></a><h3>Define</h3>
<pre>#define	SA	struct sockaddr
#define SERV_PORT 1080
#define	LISTENQ		1024
#define MAXLINE 1024
#define BUFSIZE 4096
#define BUFNUM 20
#define RECV 0
#define SEND 1
#define TO_CLIENT 1
#define TO_SERVER 0
#define FROM_CLIENT 1
#define FROM_SERVER 0
</pre>
<div class="printfooter">
<p>取自"<a href="http://dns.cs.hit.edu.cn../../../p/r/o/Talk%7EProxyProject_cd63.html">http://dns.cs.hit.edu.cn../../../p/r/o/Talk%7EProxyProject_cd63.html</a>"</p>

<p>本页面已经被浏览3,756次。 This page was last modified 06:37 2005年10月23日 by 匿名用户. Based on work by <a href="../../../l/i/u/User%7ELiuwenmao.html" class="new" title="User:Liuwenmao">刘文懋</a>, <a href="../../../x/i/o/User%7EXiongfei.html" class="new" title="User:Xiongfei">xiongfei</a> 和 <a href="../../../%E7%BD%97/%E9%98%B3/%E6%98%A5/User%7E%E7%BD%97%E9%98%B3%E6%98%A5.html" title="User:罗阳春">罗阳春</a>. </p>
</div>

</div><br style="clear:both" />

<div id='footer'><table border="0" cellspacing="0"><tr><td width='152' rowspan='1'>&nbsp;</td><td class='bottom' align='left' valign='top'><strong><a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑本页</a></strong> |
<a href="../../../p/r/o/ProxyProject_419b.html" title="ProxyProject">查看文章</a> |
<a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">较早版本</a> |
<a href="../../../w/h/a/Special%7EWhatlinkshere.html" title="Special:Whatlinkshere">链入页面</a> |
<a href="../../../r/e/c/Special%7ERecentchangeslinked.html" title="Special:Recentchangeslinked">链出更改</a>
<br /><br />

<br /><a href="../../../index.html" title="首页">首页</a> | <a href="../../../w/i/k/Wikipedia%7E%E5%85%B3%E4%BA%8E.html" title="Wikipedia:关于">关于Wikipedia</a> | <a href="../../../r/e/c/Special%7ERecentchanges.html" title="Special:Recentchanges">最近更改</a> | <form name="search" class="inline" method="post" action="../../../s/e/a/Special%7ESearch.html">
<input type="text" name="search" size="19" value="" />
<input type="submit" name="go" value="进入" />&nbsp;<input type="submit" name="fulltext" value="搜索" />
</form><br /><span id="pagestats">本页面已经被浏览3,756次。 This page was last modified 06:37 2005年10月23日 by 匿名用户. Based on work by <a href="../../../l/i/u/User%7ELiuwenmao.html" class="new" title="User:Liuwenmao">刘文懋</a>, <a href="../../../x/i/o/User%7EXiongfei.html" class="new" title="User:Xiongfei">xiongfei</a> 和 <a href="../../../%E7%BD%97/%E9%98%B3/%E6%98%A5/User%7E%E7%BD%97%E9%98%B3%E6%98%A5.html" title="User:罗阳春">罗阳春</a>. </span></td></tr></table>
</div>
</div>

<div id='quickbar'>
<a href='../../../index.html'><img src='../../../../skins/common/images/wiki.jpg' alt='[首页]' /></a>
<hr class='sep' /><a href="../../../index.html">首页</a>
<br /><a href="../../../c/o/m/WIKI-HIT_IBM_CLUB%7ECommunity_Portal_9150.html">社区</a>
<br /><a href="../../../c/u/r/Current_events.html">新闻动态</a>
<br /><a href="../../../r/e/c/Special%7ERecentchanges.html">最近更改</a>
<br /><a href="../../../r/a/n/Special%7ERandom.html">随机页面</a>
<br /><a href="../../../w/i/k/Wikipedia%7E%E5%B8%AE%E5%8A%A9.html">帮助</a>
<br /><a href="../../../s/i/t/WIKI-HIT_IBM_CLUB%7ESite_support.html">Donations</a>
<br />
<hr class='sep' /><strong><a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">编辑本页</a></strong><br /><a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">发表评论</a>
<br /><a href="../../../p/r/o/ProxyProject_419b.html" title="ProxyProject">查看文章</a>
<br /><a href="../../../p/r/o/Talk%7EProxyProject_cd63.html" title="Talk:ProxyProject">较早版本</a>
<br /><a href="../../../w/h/a/Special%7EWhatlinkshere.html" title="Special:Whatlinkshere">链入页面</a>
<br /><a href="../../../r/e/c/Special%7ERecentchangeslinked.html" title="Special:Recentchangeslinked">链出更改</a>
<br /><hr class='sep' /><a href="../../../s/p/e/Special%7ESpecialpages.html" title="Special:Specialpages">特殊页面</a>
<br /><a href="../../../w/i/k/Wikipedia%7E%E9%94%99%E8%AF%AF%E6%8A%A5%E5%91%8A.html" title="Wikipedia:错误报告">错误报告</a>
<br /></div>
<!-- Served by dns.cs.hit.edu.cn in 1351392605.02 secs. -->
</body></html>