<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-cn" lang="zh-cn" >
<head>
<title>一个更好更通俗一点的CVS指南 - WIKI-HIT IBM CLUB</title>
<meta name="KEYWORDS" content="首页,ALP,Address,Android,Android Newbie Guide,Android Project Development,Android Research Field,Android Third Party Lib And Tool,BoardGame,CSAPP" />
<meta http-equiv="Content-type" content="text/html; charset=UTF-8" />
<meta name="robots" content="index,follow" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel='stylesheet' type='text/css' media='print' href='../../../../skins/common/wikiprintable.css' />
<script type="text/javascript" src="../../../../skins/common/wikibits.js"></script>
<style type='text/css'>
/*/*/ /*<![CDATA[*/
@import "../../../../skins/common/wikistandard.css";
@import "../../../s/t/a/MediaWiki%7EStandard.css.html";
a.new, #quickbar a.new { color: #CC2200; }
.editsection { display: none; }
#quickbar { position: absolute; top: 4px; left: 4px; border-right: 1px solid gray; }
#article { margin-left: 152px; margin-right: 4px; }

/*]]>*/ /* */
</style>
</head>

<body bgcolor='#FFFFFF' onload=''>

<div id='content'>
<div id='topbar'>
<table border='0' cellspacing='0' width='98%'>
<tr>
<td width='152' rowspan='1'>&nbsp;</td><td class="top" align='left' valign='top'>
<a href="../../../index.html" title="首页">首页</a> |
<a href="../../../r/e/c/Special%7ERecentchanges.html" title="Special:Recentchanges">最近更改</a> |
<a href="../../../%E4%B8%80/%E4%B8%AA/%E6%9B%B4/%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A5%BD%E6%9B%B4%E9%80%9A%E4%BF%97%E4%B8%80%E7%82%B9%E7%9A%84CVS%E6%8C%87%E5%8D%97_df68.html" title="一个更好更通俗一点的CVS指南">编辑本页</a> |
<a href="../../../%E4%B8%80/%E4%B8%AA/%E6%9B%B4/%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A5%BD%E6%9B%B4%E9%80%9A%E4%BF%97%E4%B8%80%E7%82%B9%E7%9A%84CVS%E6%8C%87%E5%8D%97_df68.html" title="一个更好更通俗一点的CVS指南">较早版本</a><p class='subtitle'><a href="../../../%E4%B8%80/%E4%B8%AA/%E6%9B%B4/%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A5%BD%E6%9B%B4%E9%80%9A%E4%BF%97%E4%B8%80%E7%82%B9%E7%9A%84CVS%E6%8C%87%E5%8D%97_df68.html">可打印版</a> | <a href="../../../g/e/n/WIKI-HIT_IBM_CLUB%7EGeneral_disclaimer.html" title="WIKI-HIT IBM CLUB:General disclaimer">Disclaimers</a></p>
</td>
<td class="top" valign='top' align='right' nowrap='nowrap'>Not logged in
<br /><a href="../../../u/s/e/Special%7EUserlogin.html" title="Special:Userlogin">登录</a> | <a href="../../../w/i/k/Wikipedia%7E%E5%B8%AE%E5%8A%A9.html" title="Wikipedia:帮助">帮助</a>
<br /><form name="search" class="inline" method="post" action="../../../s/e/a/Special%7ESearch.html">
<input type="text" name="search" size="19" value="" />
<input type="submit" name="go" value="进入" />&nbsp;<input type="submit" name="fulltext" value="搜索" />
</form></td></tr>
</table>
</div>

<div id='article'>
<h1 class="pagetitle">一个更好更通俗一点的CVS指南</h1><p class='subtitle'>Wikipedia，自由的百科全书</p>
<p>这篇文章大部分内容是在Red Hat Linux 8.0和9.0上验证过的。
服务器的安装略过不提，因为安装了开发工具的话默认就已经有了CVS。就算没有，更新软件包就可以搞定，除非你一定要安装最新版本。
</p><p>1． 首先创建用于CVS的组和用户:
</p>
<pre>    #groupadd
    cvs
    #useradd
    cvsroot -g cvs
    #passwd
    cvsroot
</pre>
<p>OK，用户已经建立好了，cvsroot就是我们做CVS操作使用的。
</p><p>2． 修改配置文件:
</p>
<pre>    #more
    /etc/services | grep cvspserver
</pre>
<p>看看是否有:
</p>
<pre>    cvspserver
    2401/tcp #CVS client/server operations
    cvspserver
    2401/udp #CVS client/server operations
</pre>
<p>这2行。系统自带了CVS时，这2行也已经有了，只需要确认一下。如果没有，请自己加上去。然后必须创建启动脚本:
</p>
<pre>    #vi
    /etc/xinet.d/cvspserver
</pre>
<p>内容如下:
</p>
<pre>    service
    cvspserver
    {
    disable
    = no
    flags
    = REUSE
    socket_type
    = stream
    wait
    = no
    user
    = root
    server
    = /usr/bin/cvs
    server_args
    = -f --allow-root=/home/cvsroot pserver
    log_on_success
    += USERID
    log_on_failure
    += USERID
    }
</pre>
<p>其中server指定CVS可执行文件路径，默认安装就是/usr/bin/cvs。server_args指定源代码库路径及认证方式等，例子中把源代码存放在cvsroot的主目录中，也可以另外指定路径，但必须注意权限设置，pserver是密码认证方式，这种方式的安全性要差一些，但操作起来比较简单。请注意每行等号左右都有一个空格，否则无法启动服务。
</p><p>3． 初始化CVS
</p><p>切换到cvsroot用户，然后进行初始化:
</p>
<pre>    #cvs
    -d /home/cvsroot init
</pre>
<p>这个路径应该与cvspserver文件中指定的路径相同，初始化后会在此路径下面创建CVSROOT目录，存放用于CVS管理的一些文件。此时重新启动xinetd服务，CVS服务器应该能够启动了。:
</p>
<pre>    #service
    xinetd restart
</pre>
<p>当然，重新启动计算机也可以。确认是否启动:
</p>
<pre>    #netstat
    -l | grep cvspserver
</pre>
<p>如果能看到:
</p>
<pre>    tcp
    0 0 *::cvspserver *::* LISTEN
</pre>
<p>说明已经正常启动，没有的话请重新检查配置过程是否有错误或者遗漏。最后还必须检查防火墙的设置，把2401端口打开。
</p><p>4． 用户管理
</p><p>CVS默认使用系统用户登录，为了系统安全性的考虑也可以使用独立的用户管理。CVS用户名和密码保存在CVSROOT目录下的passwd文件中，格式为:
</p>
<pre>    用户名::密码::系统用户
</pre>
<p>也就是说，它把CVS用户映射到系统用户，这样我们就可以通过系统用户的权限设置来分配给用户不同的权限，而不需要让用户知道系统用户名和密码。 passwd文件默认并不存在，我们必须自己创建。文件中的密码字段使用MD5加密，不幸的是CVS没有提供添加用户名的命令，所以我们借用Apache 的命令来完成这项工作:
</p>
<pre>    #htpasswd
    passwd username
</pre>
<p>这个命令为username指定密码，并保存在passwd中，文件不存在时会自动创建。htpasswd命令不是为CVS而设，因此总有一些遗憾，它不能自动添加映射到的用户名，不过没关系，我们设置好密码后，自己把这部分加上。我的做法是映射到cvsroot用户，如果需要映射其他的用户，请注意给相应的目录设置好权限，否则CVS用户可能无法访问源代码仓库。要彻底防止使用系统帐号登陆，可以编辑CVSROOT目录下的config文件，把:
</p>
<pre>    #SystemAuth=no
</pre>
<p>这一行前面的#去掉，CVS就不会验证系统用户了，否则当用户名不在passwd文件中时，CVS会进行系统用户的验证。此外还必须配置读写权限，使用 CVSROOT目录下的readers和writers文件进行这个工作。这2个文件默认也是没有的，没关系，自己创建就可以了。readers文件记录拥有只读权限的用户名，每行一个用户；writers文件记录拥有读写权限的用户名，也是每行一个用户。注意， readers文件比writers优先，也就是说出现在readers中的用户将会是只读的，不管writers文件中是否存在该用户。配置完毕，先测试一下:
</p>
<pre>    #cvs
    -d “::pserver::username@127.0.0.1::/home/cvsroot” login
</pre>
<p>这里假设用户名是username，本机登陆。出现密码提示，输入正确的密码后，登陆成功。如果提示访问被拒绝，请检查用户权限、目录权限以及防火墙设置。建议设置环境变量CVSROOT:
</p>
<pre>    #export
    CVSROOT=::pserver::username@127.0.0.1::/home/cvsroot
</pre>
<p>以后就不需要输入-d参数了，但-d参数会覆盖这个环境变量的设置。
</p><p>5． 源代码仓库的备份和移动
</p><p>基本上，CVS的源代码仓库没有什么特别之处，完全可以用文件备份的方式进行备份。需要注意的只是，应该确认备份的过程中没有用户提交修改，具体的做法可以是停止CVS服务器或者使用锁等等。恢复时只需要把这些文件按原来的目录结构存放好，因为CVS的每一个模块都是单独的一个目录，与其他模块和目录没有任何瓜葛，相当方便。甚至只需要在仓库中删除一个目录或者文件，便可以删除该模块的一些内容，不过并不建议这么做，使用CVS的删除功能将会有一个历史记录，而对仓库的直接删除不留任何痕迹，这对项目管理是不利的。移动仓库与备份相似，只需要把该模块的目录移动到新的路径，便可以使用了。如果不幸在备份之后有过一些修改并且执行了提交，当服务器出现问题需要恢复源代码仓库时，开发者提交新的修改就会出现版本不一致的错误。此时只需要把 CVS相关的目录和文件删除，即可把新的修改提交。
</p><p>6． 更进一步的管理
</p><p>CVSROOT目录下还有很多其他功能，其中最重要的就是modules文件。这个文件定义了源代码库的模块，下面是一个例子:
</p>
<pre>    Linux    
    Linux
    Kernel  
    Linux/kernel
</pre>
<p>这个文件的内容按行排列，每一行定义一个模块，首先是模块名，然后是模块路径，这是相对于CVS根目录的路径。它定义了两个模块，第一个是Linux模块，它位于Linux目录中，第二个是Kernel模块，这是Linux模块的子模块。 modules文件并非必须的，它的作用相当于一个索引，部分CVS客户端软件通过它可以快速找到相应的模块，比如WinCVS。
</p><p>7． 协同开发的问题
</p><p>默认方式下，CVS允许多个用户编辑同一个文件，这对一个协作良好的团队来说不会有什么问题，因为多个开发者同时修改同一个文件的同一部分是不正常的，这在项目管理中就应该避免，出现这种情况说明项目组内部没有统一意见。而多个开发者修改文件的不同部分，CVS可以很好的管理。如果觉得这种方式难以控制， CVS也提供了解决办法，可以使用cvs admin -l进行锁定，这样一个开发者正在做修改时CVS就不会允许其他用户checkout。这里顺便说明一下文件格式的问题，对于文本格式，CVS可以进行历史记录比较、版本合并等工作，而二进制文件不支持这个操作，比如word文档、图片等就应该以二进制方式提交。对于二进制方式，由于无法进行合并，在无法保证只有一个用户修改文件的情况下，建议使用加锁方式进行修改。必须注意的是，修改完毕记得解锁。从1.6版本开始，CVS引入了监视的概念，这个功能可以让用户随时了解当前谁在修改文件，并且CVS可以自动发送邮件给每一个监视的用户告知最新的更新。
</p><p>8． 建立多个源代码仓库
</p><p>如果需要管理多个开发组，而这些开发组之间不能互相访问，可以有2个办法::
</p><p>a．共用一个端口，需要修改cvspserver文件，给server_args指定多个源代码路径，即多个—allow-root参数。由于xinetd的 server_args长度有限制，可以在cvspserver文件中把服务器的设置重定向到另外一个文件，如:
</p>
<pre>    server
    = /home/cvsroot/cvs.run
</pre>
<p>然后创建/home/cvsroot/cvs.run文件，该文件必须可执行，内容格式为:
</p>
<pre>    #!/bin/bash
    /usr/bin/cvs
    -f
    --allow-root=/home/cvsroot/src1
    --allow-root=/home/cvsroot/src2
    pserver
</pre>
<p>注意此时源代码仓库不再是/home/cvsroot，进行初始化的时候要分别对这两个仓库路径进行初始化，而不再对/home/cvsroot路径进行初始化。
</p><p>b． 采用不同的端口提供服务
</p><p>重复第2步和第3步，为不同的源代码仓库创建不同服务名的启动脚本，并为这些服务名指定不同的端口，初始化时也必须分别进行初始化。
</p>
<div class="printfooter">
<p>取自"<a href="http://dns.cs.hit.edu.cn../../../%E4%B8%80/%E4%B8%AA/%E6%9B%B4/%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A5%BD%E6%9B%B4%E9%80%9A%E4%BF%97%E4%B8%80%E7%82%B9%E7%9A%84CVS%E6%8C%87%E5%8D%97_df68.html">http://dns.cs.hit.edu.cn../../../%E4%B8%80/%E4%B8%AA/%E6%9B%B4/%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A5%BD%E6%9B%B4%E9%80%9A%E4%BF%97%E4%B8%80%E7%82%B9%E7%9A%84CVS%E6%8C%87%E5%8D%97_df68.html</a>"</p>

<p>本页面已经被浏览14次。 This page was last modified 15:00 2006年6月16日 by <a href="../../../c/o/w/User%7ECowoo.html" title="User:Cowoo">陈伟</a>.  </p>
</div>

</div><br style="clear:both" />

<div id='footer'><table border="0" cellspacing="0"><tr><td width='152' rowspan='1'>&nbsp;</td><td class='bottom' align='left' valign='top'><strong><a href="../../../%E4%B8%80/%E4%B8%AA/%E6%9B%B4/%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A5%BD%E6%9B%B4%E9%80%9A%E4%BF%97%E4%B8%80%E7%82%B9%E7%9A%84CVS%E6%8C%87%E5%8D%97_df68.html" title="一个更好更通俗一点的CVS指南">编辑本页</a></strong> |
<a href="../../../%E4%B8%80/%E4%B8%AA/%E6%9B%B4/Talk%7E%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A5%BD%E6%9B%B4%E9%80%9A%E4%BF%97%E4%B8%80%E7%82%B9%E7%9A%84CVS%E6%8C%87%E5%8D%97_8acc.html" title="Talk:一个更好更通俗一点的CVS指南">讨论本页</a> |
<a href="../../../%E4%B8%80/%E4%B8%AA/%E6%9B%B4/%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A5%BD%E6%9B%B4%E9%80%9A%E4%BF%97%E4%B8%80%E7%82%B9%E7%9A%84CVS%E6%8C%87%E5%8D%97_df68.html" title="一个更好更通俗一点的CVS指南">较早版本</a> |
<a href="../../../w/h/a/Special%7EWhatlinkshere.html" title="Special:Whatlinkshere">链入页面</a> |
<a href="../../../r/e/c/Special%7ERecentchangeslinked.html" title="Special:Recentchangeslinked">链出更改</a>
<br /><br />

<br /><a href="../../../index.html" title="首页">首页</a> | <a href="../../../w/i/k/Wikipedia%7E%E5%85%B3%E4%BA%8E.html" title="Wikipedia:关于">关于Wikipedia</a> | <a href="../../../r/e/c/Special%7ERecentchanges.html" title="Special:Recentchanges">最近更改</a> | <form name="search" class="inline" method="post" action="../../../s/e/a/Special%7ESearch.html">
<input type="text" name="search" size="19" value="" />
<input type="submit" name="go" value="进入" />&nbsp;<input type="submit" name="fulltext" value="搜索" />
</form><br /><span id="pagestats">本页面已经被浏览14次。 This page was last modified 15:00 2006年6月16日 by <a href="../../../c/o/w/User%7ECowoo.html" title="User:Cowoo">陈伟</a>.  </span></td></tr></table>
</div>
</div>

<div id='quickbar'>
<a href='../../../index.html'><img src='../../../../skins/common/images/wiki.jpg' alt='[首页]' /></a>
<hr class='sep' /><a href="../../../index.html">首页</a>
<br /><a href="../../../c/o/m/WIKI-HIT_IBM_CLUB%7ECommunity_Portal_9150.html">社区</a>
<br /><a href="../../../c/u/r/Current_events.html">新闻动态</a>
<br /><a href="../../../r/e/c/Special%7ERecentchanges.html">最近更改</a>
<br /><a href="../../../r/a/n/Special%7ERandom.html">随机页面</a>
<br /><a href="../../../w/i/k/Wikipedia%7E%E5%B8%AE%E5%8A%A9.html">帮助</a>
<br /><a href="../../../s/i/t/WIKI-HIT_IBM_CLUB%7ESite_support.html">Donations</a>
<br />
<hr class='sep' /><strong><a href="../../../%E4%B8%80/%E4%B8%AA/%E6%9B%B4/%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A5%BD%E6%9B%B4%E9%80%9A%E4%BF%97%E4%B8%80%E7%82%B9%E7%9A%84CVS%E6%8C%87%E5%8D%97_df68.html" title="一个更好更通俗一点的CVS指南">编辑本页</a></strong>
<br /><a href="../../../%E4%B8%80/%E4%B8%AA/%E6%9B%B4/Talk%7E%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A5%BD%E6%9B%B4%E9%80%9A%E4%BF%97%E4%B8%80%E7%82%B9%E7%9A%84CVS%E6%8C%87%E5%8D%97_8acc.html" title="Talk:一个更好更通俗一点的CVS指南">讨论本页</a>
<br /><a href="../../../%E4%B8%80/%E4%B8%AA/%E6%9B%B4/%E4%B8%80%E4%B8%AA%E6%9B%B4%E5%A5%BD%E6%9B%B4%E9%80%9A%E4%BF%97%E4%B8%80%E7%82%B9%E7%9A%84CVS%E6%8C%87%E5%8D%97_df68.html" title="一个更好更通俗一点的CVS指南">较早版本</a>
<br /><a href="../../../w/h/a/Special%7EWhatlinkshere.html" title="Special:Whatlinkshere">链入页面</a>
<br /><a href="../../../r/e/c/Special%7ERecentchangeslinked.html" title="Special:Recentchangeslinked">链出更改</a>
<br /><hr class='sep' /><a href="../../../s/p/e/Special%7ESpecialpages.html" title="Special:Specialpages">特殊页面</a>
<br /><a href="../../../w/i/k/Wikipedia%7E%E9%94%99%E8%AF%AF%E6%8A%A5%E5%91%8A.html" title="Wikipedia:错误报告">错误报告</a>
<br /></div>
<!-- Served by dns.cs.hit.edu.cn in 1351392790.65 secs. -->
</body></html>